/*
 *
 * This software is governed by the Broadcom Switch APIs license.
 * This license is set out in https://raw.githubusercontent.com/Broadcom-Network-Switching-Software/OpenMDK/master/Legal/LICENSE file.
 * 
 * Copyright 2007-2020 Broadcom Inc. All rights reserved.
 */
#include <bmd_config.h>
#if CDK_CONFIG_INCLUDE_BCM56160_A0 == 1

#include <bmd/bmd.h>
#include <bmd/bmd_device.h>
#include <bmd/bmd_phy_ctrl.h>

#include <cdk/arch/xgsd_chip.h>
#include <cdk/cdk_assert.h>
#include <cdk/cdk_debug.h>
#include <cdk/chip/bcm56160_a0_defs.h>

#include "bcm56160_a0_bmd.h"
#include "bcm56160_a0_internal.h"

#if BMD_CONFIG_INCLUDE_PHY == 1
#include <phy/phy_buslist.h>

/* PHY bus driver for QSGMII, embedded gphy mode */
static phy_bus_t *bcm56160_phy_bus[] = {
#ifdef PHY_BUS_BCM56160_MIIM_INT_INSTALLED
    &phy_bus_bcm56160_miim_int,
#endif
#ifdef PHY_BUS_BCM956160K_MIIM_EXT_INSTALLED
    &phy_bus_bcm956160k_miim_ext,
#endif
    NULL
};

/* PHY bus driver for SGMII mode */
static phy_bus_t *bcm56160_sgmii_phy_bus[] = {
#ifdef PHY_BUS_BCM56160_MIIM_INT_INSTALLED
    &phy_bus_bcm56160_miim_int,
#endif
    NULL,
    NULL
};

/* PHY bus driver for BY_PASS mode */
static phy_bus_t *bcm56160_bypass_phy_bus[] = {
#ifdef PHY_BUS_BCM56160_MIIM_INT_INSTALLED
    &phy_bus_bcm56160_gphy_bypass_miim_int,
#endif
#ifdef PHY_BUS_BCM956160K_MIIM_EXT_INSTALLED
    &phy_bus_bcm956160k_miim_ext,
#endif
    NULL
};

#define PHY_BUS_SET(_u,_p,_b) bmd_phy_bus_set(_u,_p,_b)

#else

#define PHY_BUS_SET(_u,_p,_b)

#endif /* BMD_CONFIG_INCLUDE_PHY */

/*
* The dynamic configuration options for BCM56160 are defined as
* follows:
*
* Bit [31] : Select between SGMII and QSGMII
* Bit [7:0] : Select port configuration option
*
*
* SGMII mode:
*
* Use the DCFG_SGMII_MODE flag to select SGMII mode.
*
*
* Port configuration option:
*
* The port configuration options must be defined according to the
* Programmer's Reference Guide (56160-PR101-R) using the following
* encoding:
*
* Option 1 : 0x1
* Option 1A : 0x1A
* ...
* Option 8 : 0x8
* Option 8A : 0x8A
*
*
* For example to select port configuration option 6A in SGMII mode:
*
* #include <cdk/chip/bcm56160_a0_defs.h>
*
* CDK_CHIP_CONFIG(unit) = DCFG_SGMII_MODE | 0x6A;
 */
#define PORT_CONFIG_MASK        0xFF

/* 24P 1G + 4P (1G/10G) + 2P (1G/10G) PHY */
static int p2l_mapping_1[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  28,  29,  30,  31,
     -1,  -1
};
static int port_speed_max_1[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110, 110, 110, 110, 110,
     -1,  -1
};

/* 24P 1G + 4P (1G/10G) + 2P (1G/10G) PHY */
static int p2l_mapping_10[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  -1,  -1,  28,  29,
     30,  31
};
static int port_speed_max_10[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110,  -1,  -1, 110, 110,
    110, 110
};

/* 24P 1G + 2P (1G/10G) + 2P (1G/10G) + 2P 25G PHY */
static int p2l_mapping_2[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  28,  29,  30,  -1,
     31,  -1
};
static int port_speed_max_2[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110, 110, 110, 250,  -1,
    250, -1
};

/* 24P 1G + 2P (1G/10G) + 2P (1G/10G) + 2P 25G PHY */
static int p2l_mapping_20[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  -1,  27,  -1,  28,  29,
     30,  31
};
static int port_speed_max_20[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 250,  -1, 250,  -1, 110, 110,
    110, 110
};

/* 24P 1G + 4P 1G/10G + 1P XAUI PHY */
static int p2l_mapping_3[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  28,  29,  30,  -1,
     -1,  -1
};
static int port_speed_max_3[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110, 110, 110, 100,  -1,
     -1,  -1
};

/* 24P 1G + 2P XAUI PHY */
static int p2l_mapping_4[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  -1,  -1,  -1,  27,  -1,
     -1,  -1
};
static int port_speed_max_4[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 100,  -1,  -1,  -1, 100,  -1,
     -1,  -1
};


/* 24P 1G + 4P 1G/10G + 2P 20G PHY */
static int p2l_mapping_5[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  28,  -1,  29,  30,
     31,  -1
};
static int port_speed_max_5[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110, 210,  -1, 110, 110,
    210,  -1
};

/* 24P 1G + 2P 1G/10G + 2P 20G + 2P 25G PHY */
static int p2l_mapping_6[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  28,  -1,  29,  -1,
     30,  -1
};
static int port_speed_max_6[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110, 210,  -1, 250,  -1,
    250,  -1
};

/* 24P 1G + 2P 1G/10G + 2P 20G + 2P 25G PHY */
static int p2l_mapping_60[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  -1,  27,  -1,  28,  29,
     30,  -1
};
static int port_speed_max_60[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 250,  -1, 250,  -1, 110, 110,
    210,  -1
};

/* 24P 1G + 2P 40G PHY */
static int p2l_mapping_7[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  -1,  -1,  -1,  27,  -1,
     -1,  -1
};
static int port_speed_max_7[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 420,  -1,  -1,  -1, 420,  -1,
     -1,  -1
};

/* 24P 1G + 1P 40G  + 2P 25G PHY */
static int p2l_mapping_8[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  -1,  27,  -1,  28,  -1,
     -1,  -1
};
static int port_speed_max_8[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 250,  -1, 250,  -1, 420,  -1,
     -1,  -1
};

/* 24P 1G + 1P 40G  + 2P 25G PHY */
static int p2l_mapping_80[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  -1,  -1,  -1,  27,  -1,
     28,  -1
};
static int port_speed_max_80[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 420,  -1,  -1,  -1, 250,  -1,
    250,  -1
};

/* 24P 1G + 2P 20G  + 2P 25G */
static int p2l_mapping_9[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  27,  -1,  28,  -1,
     29,  -1
};
static int port_speed_max_9[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1, 
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10, 210,  -1, 210,  -1, 250,  -1,
    250,  -1
};

/* 24P 1G + 2P 20G  + 2P 25G */
static int p2l_mapping_90[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  27,  -1,  28,  -1,
     29,  -1
};
static int port_speed_max_90[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1, 
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10, 250,  -1, 250,  -1, 210,  -1,
    210,  -1
};

/* 24P 1G +4P 1G/10G +2P 1G/10G + gphy bypass */
static int p2l_mapping_1001[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  27,  28,  29,  30,  31,
     -1,  -1
};
static int port_speed_max_1001[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 110, 110, 110, 110, 110, 110,
     -1,  -1
};

/* 24P 1G +4P 1G/10G +2P 1G/10G + gphy bypass */
static int p2l_mapping_1010[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  27,  -1,  -1,  28,  29,
     30,  31
};
static int port_speed_max_1010[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 110, 110,  -1,  -1, 110, 110,
    110, 110
};

/* 24P 1G + 2P 1G/10G + 2P 1G/10G + 2P 25G + gphy bypass */
static int p2l_mapping_1002[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  27,  28,  29,  30,  -1,
     31,  -1
};
static int port_speed_max_1002[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 110, 110, 110, 110, 250,  -1,
    250,  -1
};

/* 24P 1G + 2P 1G/10G + 2P 1G/10G + 2P 25G + gphy bypass */
static int p2l_mapping_1020[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  27,  -1,  28,  29,
     30,  31
};
static int port_speed_max_1020[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 250,  -1, 250,  -1, 110, 110,
    110, 110
};

/* 24P 1G +4P 1G/10G+1P XAUI + gphy bypass */
static int p2l_mapping_1003[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  27,  28,  29,  30,  -1,
     -1,  -1
};
static int port_speed_max_1003[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 110, 110, 110, 110, 100,  -1,
     -1,  -1
};

/* 24P 1G +2P XAUI + gphy bypass */
static int p2l_mapping_1004[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  -1,  -1,  27,  -1,
     -1,  -1
};
static int port_speed_max_1004[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 100,  -1,  -1,  -1, 100,  -1,
     -1,  -1
};


/* 24P 1G + 4P 1G/10G + 2P 20G + gphy bypass */
static int p2l_mapping_1005[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  27,  28,  -1,  29,  30,
     31,  -1
};
static int port_speed_max_1005[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 110, 110, 210,  -1, 110, 110,
    210,  -1
};

/* 24P 1G +2P 1G/10G + 1P 20G + 2P 25G + gphy bypass */
static int p2l_mapping_1006[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  27,  28,  -1,  29,  -1,
     30,  -1
};
static int port_speed_max_1006[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 110, 110, 210,  -1, 250,  -1,
    250,  -1
};

/* 24P 1G +2P 1G/10G + 1P 20G + 2P 25G + gphy bypass */
static int p2l_mapping_1060[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  27,  -1,  28,  29,
     30,  -1
};
static int port_speed_max_1060[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 250,  -1, 250,  -1, 110, 110,
    210,  -1
};

/* 24P 1G +2P 40G + gphy bypass */
static int p2l_mapping_1007[] = { 
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  -1,  -1,  27,  -1,
     -1,  -1
};
static int port_speed_max_1007[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 420,  -1,  -1,  -1, 420,  -1,
     -1,  -1
};

/* 24P 1G +1P 40G + 2P 25G + gphy bypass */
static int p2l_mapping_1008[] = { 
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  27,  -1,  28,  -1,
     -1,  -1
};
static int port_speed_max_1008[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 250,  -1, 250,  -1, 420,  -1,
     -1,  -1
};

/* 24P 1G +1P 40G + 2P 25G + gphy bypass */
static int p2l_mapping_1080[] = { 
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  -1,  -1,  27,  -1,
     28,  -1
};
static int port_speed_max_1080[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 420,  -1,  -1,  -1, 250,  -1,
    250,  -1
};

/* 24P 1G + 1P 20G + 2P 25G + gphy bypass */
static int p2l_mapping_1009[] = { 
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  27,  -1,  28,  -1,
     29,  -1
};
static int port_speed_max_1009[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 210,  -1, 210,  -1, 250,  -1,
    250,  -1
};

/* 24P 1G + 1P 20G + 2P 25G + gphy bypass */
static int p2l_mapping_1090[] = { 
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  27,  -1,  28,  -1,
     29,  -1
};
static int port_speed_max_1090[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 250,  -1, 250,  -1, 210,  -1,
    210,  -1
};

/* 24P 1G + 4P 1G PHY */
static int p2l_mapping_11[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  28,  29,  -1,  -1,
     -1,  -1
};
static int port_speed_max_11[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1
};

/* 24P 1G + 4P 1G PHY */
static int p2l_mapping_110[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  -1,  -1,  -1,  -1,  26,  27,
     28,  29
};
static int port_speed_max_110[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  10,  10,
     10,  10
};

/* 24P 1G + 2P 1G + 2P 13G PHY */
static int p2l_mapping_12[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  -1,  -1,  28,  -1,
     29,  -1
};
static int port_speed_max_12[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  -1,  -1, 130,  -1,
    130,  -1
};

/* 24P 1G + 4P 1G PHY + gphy bypass*/
static int p2l_mapping_1011[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  27,  28,  29,  -1,  -1,
     -1,  -1
};
static int port_speed_max_1011[] = {
    -1,  -1,  10,  10,  10,  10,  10,  10,
    10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
    -1,  -1,  10,  10,  10,  10,  10,  10, 
    10,  10,  10,  10,  10,  10,  10,  10, 
    10,  10,  10,  10,  10,  10,  -1,  -1,
    -1,  -1
};

/* 24P 1G + 4P 1G PHY + gphy bypass*/
static int p2l_mapping_1110[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  -1,  -1,  -1,  -1,  26,  27,
     28,  29
};
static int port_speed_max_1110[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10,  -1,  -1,  -1,  -1,  10,  10,
     10,  10     
};

/* 24P 1G + 2P 1G + 2P 13G PHY */
static int p2l_mapping_1012[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  27,  -1,  -1,  28,  -1,
     29,  -1
};
static int port_speed_max_1012[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  -1,  -1, 130,  -1,
    130,  -1
};

/* 8P 1G + 2P 1G/2.5G/5G/10G PHY */
static int p2l_mapping_21[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  -1,  -1,  -1,  11,  -1,
     -1,  -1
};
static int port_speed_max_21[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1, 110,  -1,  -1,  -1, 110,  -1,
     -1,  -1
};

/* 8P 1G + 4P 1G/2.5G + 4P 1G/2.5G PHY */
static int p2l_mapping_22[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17
};
static int port_speed_max_22[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  25,  25,  25,  25,  25,  25,
     25,  25
};

/* 8P 1G + XAUI + XAUI PHY */
static int p2l_mapping_23[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  -1,  -1,  -1,  11,  -1,
     -1,  -1
};
static int port_speed_max_23[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1, 100,  -1,  -1,  -1, 100,  -1,
     -1,  -1
};

/* 8P 1G (PHY) + 2P 1G/2.5G/5G/10G + gphy bypass */
static int p2l_mapping_1021[] = {
      0,  -1,   2,   3,   4,   5,  -1, -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,
     -1,  -1,   6,   7,   8,   9,  -1, -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1, -1, 
     -1,  -1,  10,  -1,  -1,  -1,  11, -1,
     -1,  -1
};
static int port_speed_max_1021[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1, 110,  -1,  -1,  -1, 110,  -1,
     -1,  -1
};

/* 8P 1G (PHY) + 4P 1G/2.5G OR 1P XAUI + 4P 1G/2.5G OR 1P XAUI + gphy bypass */
static int p2l_mapping_1022[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1, 
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17
};
static int port_speed_max_1022[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  25,  25,  25,  25,  25,  25,
     25,  25
};

/* the same as 1021 */
static int p2l_mapping_1023[] = {
      0,  -1,   2,   3,   4,   5,  -1, -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1, -1,
     -1,  -1,   6,   7,   8,   9,  -1, -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1, -1, 
     -1,  -1,  10,  -1,  -1,  -1,  11, -1,
     -1,  -1
};
static int port_speed_max_1023[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1, 110,  -1,  -1,  -1, 110,  -1,
     -1,  -1
};

/* 24P 1G + 4P 1G/10G + 2P 1G/10G PHY */
static int p2l_mapping_31[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  28,  29,  30,  31,
     -1,  -1
};
static int port_speed_max_31[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110, 110, 110, 110, 110,
     -1,  -1
};

/* 24P 1G + 2P 1G/10G + 4P 1G/10G PHY */
static int p2l_mapping_310[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  -1,  -1,  28,  29,
     30,  31
};
static int port_speed_max_310[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110,  -1,  -1, 110, 110,
    110, 110
};

/* 24P 1G + 2P 1G/10G + 2P 25G PHY */
static int p2l_mapping_32[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  -1,  -1,  28,  -1,
     29,  -1
};
static int port_speed_max_32[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110,  -1,  -1, 250,  -1,
    250,  -1
};

/* 24P 1G + 2P 25G + 2P 1G/10G PHY */
static int p2l_mapping_320[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  -1,  27,  -1,  28,  29,
     -1,  -1
};
static int port_speed_max_320[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10, 250,  -1, 250,  -1, 110, 110,
     -1,  -1
};

/* 24P 1G + 4P 1G/10G + 1P XAUI PHY */
static int p2l_mapping_33[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  28,  29,  30,  -1,
     -1,  -1
};
static int port_speed_max_33[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110, 110, 110, 100,  -1,
     -1,  -1
};

/* 24P 1G + 2P XAUI PHY */
static int p2l_mapping_34[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  -1,  -1,  -1,  27,  -1,
     -1,  -1
};
static int port_speed_max_34[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10, 100,  -1,  -1,  -1, 100,  -1,
     -1,  -1
};

/* 24P 1G + 2P 1G/10G + 2P 20G PHY */
static int p2l_mapping_35[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  -1,  27,  -1,  28,  -1,
     29,  -1
};
static int port_speed_max_35[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10, 110,  -1, 210,  -1, 110,  -1,
    210,  -1
};

/* 24P 1G + 1P 1G/10G + 1P 20G + 2P 25G PHY */
static int p2l_mapping_36[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  -1,  27,  -1,  28,  -1,
     29,  -1
};
static int port_speed_max_36[] = {
     -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10, 110,  -1, 210,  -1, 250,  -1,
    250,  -1
};

/* 24P 1G +4P 1G/10G +2P 1G/10G + gphy bypass */
static int p2l_mapping_1031[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  28,  29,  30,  31,
     -1,  -1
};
static int port_speed_max_1031[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 110, 110, 110, 110, 110, 110,
     -1,  -1
};

/* 24P 1G +2P 1G/10G +4P 1G/10G + gphy bypass */
static int p2l_mapping_1310[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  -1,  -1,  28,  29,
     30,  31
};
static int port_speed_max_1310[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110,  -1,  -1, 110, 110,
    110, 110
};

/* 24P 1G + 2P 1G/10G + 2P 25G + gphy bypass */
static int p2l_mapping_1032[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  27,  -1,  -1,  28,  -1,
     29,  -1
};
static int port_speed_max_1032[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 110, 110,  -1,  -1, 250,  -1,
    250,  -1
};

/* 24P 1G + 2P 25G + 2P 1G/10G + gphy bypass */
static int p2l_mapping_1320[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  27,  -1,  28,  29,
     -1,  -1
};
static int port_speed_max_1320[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 250,  -1, 250,  -1, 110, 110,
     -1,  -1
};

/* 24P 1G +4P 1G/10G+1P XAUI + gphy bypass */
static int p2l_mapping_1033[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  27,  28,  29,  30,  -1,
     -1,  -1
};
static int port_speed_max_1033[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 110, 110, 110, 110, 100,  -1,
     -1,  -1
};

/* 24P 1G +2P XAUI + gphy bypass */
static int p2l_mapping_1034[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  -1,  -1,  27,  -1,
     -1,  -1
};
static int port_speed_max_1034[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 100,  -1,  -1,  -1, 100,  -1,
     -1,  -1
};

/* 24P 1G + 2P 1G/10G + 2P 20G + gphy bypass */
static int p2l_mapping_1035[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  27,  -1,  28,  -1,
     29,  -1
};
static int port_speed_max_1035[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 110,  -1, 210,  -1, 110,  -1,
    210,  -1
};

/* 24P 1G +1P 1G/10G + 1P 20G + 2P 25G + gphy bypass */
static int p2l_mapping_1036[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  27,  -1,  28,  -1,
     29,  -1
};
static int port_speed_max_1036[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 110,  -1, 210,  -1, 250,  -1,
    250,  -1
};

/* 16P 1G + 8P 1G/2.5G + 4P 10G (Uplink) + 2P 10G (stack) PHY */
static int p2l_mapping_43[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  28,  -1,  29,  30,
     31,  -1
};
static int port_speed_max_43[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110, 110,  -1, 110, 110,
    110, -1
};

/* 16P 1G + 8P 1G/2.5G + 2P 10G (Uplink) + 1P 10G (stack) + 2P 25G PHY */
static int p2l_mapping_44[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  -1,  27,  -1,  28,  29,
     30,  -1
};
static int port_speed_max_44[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 250,  -1, 250,  -1, 110, 110,
    110,  -1
};

/* 16P 1G + 8P 1G/2.5G + 2P 10G (Uplink) + 1P 20G (stack) + 2P 25G PHY */
static int p2l_mapping_440[] = {
      0,  -1,   2,   3,   4,   5,  -1,  -1,
     -1,  -1,   6,   7,   8,   9,  10,  11,
     12,  13,  14,  15,  16,  17,  -1,  -1,
     -1,  -1,  18,  19,  20,  21,  22,  23,
     24,  25,  26,  27,  28,  -1,  29,  -1,
     30,  -1
};
static int port_speed_max_440[] = {
     -1,  -1,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110, 110,  -1, 250,  -1,
    250,  -1
};

/* 16P 1G + 8P 1G/2.5G + 4P 10G (Uplink) + 2P 10G (stack) + gphy bypass */
static int p2l_mapping_1043[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  27,  28,  -1,  29,  30,
     31,  -1
};
static int port_speed_max_1043[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10, 
     10,  10,  10,  10,  10,  10,  10,  10, 
     10,  10, 110, 110, 110,  -1, 110, 110,
    110, -1
};


/* 16P 1G + 8P 1G/2.5G + 2P 10G (Uplink) + 1P 10G (stack) + 2P 25G (Phy) */
static int p2l_mapping_1044[] = {
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  -1,  27,  -1,  28,  29,
     30,  31
};
static int port_speed_max_1044[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10, 250,  -1, 250,  -1, 110, 110,
    110,  -1
};


/* 16P 1G + 8P 1G/2.5G + 2P 10G (Uplink) + 1P 20G (stack) + 2P 25G (Phy)
 * + gphy bypass
 */
static int p2l_mapping_1440[] = { 
      0,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23, 
     24,  25,  26,  27,  28,  29,  30,  -1,
     31,  -1 
};    
static int port_speed_max_1440[] = {
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10, 110, 110, 110,  -1, 250,  -1,
    250,  -1
};

/* 24P 1G (PHY) */
static int p2l_mapping_51[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,   2,   3,   4,   5,   6,   7,
      8,   9,  10,  11,  12,  13,  14,  15,
     16,  17,  18,  19,  20,  21,  22,  23,
     24,  25,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1
};
static int port_speed_max_51[] = {
      0,  -1,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  10,  10,  10,  10,  10,  10,
     10,  10,  -1,  -1,  -1,  -1,  -1,  -1,
     -1,  -1
};

/* TDM table */
static int tdm_seq_1[50] = {
    38, 36, 34, 12,
    39, 37, 35, 13,
     2, 18, 26, 14,
    38, 36, 34, 15,
    39, 37, 35, 16,
     3, 19, 27, 17,
    38, 36, 34, 28,
    39, 37, 35, 29,
     4, 20, 10, 30,
    38, 36, 34, 31,
    39, 37, 35, 32,
     5, 21, 11, 33,
     0, 63
};

static int tdm_seq_10[50] = {
    38, 40, 34, 12,
    39, 41, 35, 13,
     2, 18, 26, 14,
    38, 40, 34, 15,
    39, 41, 35, 16,
     3, 19, 27, 17,
    38, 40, 34, 28,
    39, 41, 35, 29,
     4, 20, 10, 30,
    38, 40, 34, 31,
    39, 41, 35, 32,
     5, 21, 11, 33,
     0, 63
};

static int tdm_seq_2[64] = {
    38, 40, 34, 10,
    38, 40, 35, 11,
     2, 18, 36, 12,
    38, 40, 37, 13,
    38, 40, 34, 14,
     3, 19, 35, 15,
    38, 40, 36, 16,
    38, 40, 37, 17,
     4, 20, 34, 26,
    38, 40, 35, 27,
    38, 40, 36, 28,
     5, 21, 37, 29,
    38, 40, 34, 30,
     0, 63, 35, 31,
    38, 40, 36, 32,
    63, 63, 37, 33
};

static int tdm_seq_20[64] = {
    34, 36, 38, 10,
    34, 36, 39, 11,
     2, 18, 40, 12,
    34, 36, 41, 13,
    34, 36, 38, 14,
     3, 19, 39, 15,
    34, 36, 40, 16,
    34, 36, 41, 17,
     4, 20, 38, 26,
    34, 36, 39, 27,
    34, 36, 40, 28,
     5, 21, 41, 29,
    34, 36, 38, 30,
     0, 63, 39, 31,
    34, 36, 40, 32,
    63, 63, 41, 33
};

/* Same as tdm_seq_1 */
static int tdm_seq_3[50] = {
    38, 36, 34, 12,
    39, 37, 35, 13,
     2, 18, 26, 14,
    38, 36, 34, 15,
    39, 37, 35, 16,
     3, 19, 27, 17,
    38, 36, 34, 28,
    39, 37, 35, 29,
     4, 20, 10, 30,
    38, 36, 34, 31,
    39, 37, 35, 32,
     5, 21, 11, 33,
     0, 63
};

/* Same as tdm_seq_1 */
static int tdm_seq_4[50] = {
    38, 36, 34, 12,
    39, 37, 35, 13,
     2, 18, 26, 14,
    38, 36, 34, 15,
    39, 37, 35, 16,
     3, 19, 27, 17,
    38, 36, 34, 28,
    39, 37, 35, 29,
     4, 20, 10, 30,
    38, 36, 34, 31,
    39, 37, 35, 32,
     5, 21, 11, 33,
     0, 63
};

static int tdm_seq_5[66] = {
    36, 34, 38,  2,
    40, 35, 39,  3,
    36, 10, 26,  4,
    40, 11, 27,  5,
    36, 34, 38, 18,
    40, 35, 39, 19,
    36, 12, 28, 20,
    40, 13, 29, 21,
    36, 34, 38,  2,
    40, 35, 39,  3,
    36, 14, 30,  4,
    40, 15, 31,  5,
    36, 34, 38, 18,
    40, 35, 39, 19,
    36, 16, 32, 20,
    40, 17, 33, 21,
     0, 63
};

static int tdm_seq_6[64] = {
    38, 40, 34, 10,
    38, 40, 35, 11,
     2, 18, 36, 12,
    38, 40, 36, 13,
    38, 40, 34, 14,
     3, 19, 35, 15,
    38, 40, 36, 16,
    38, 40, 36, 17,
     4, 20, 34, 26,
    38, 40, 35, 27,
    38, 40, 36, 28,
     5, 21, 36, 29,
    38, 40, 34, 30,
     0, 63, 35, 31,
    38, 40, 36, 32,
    63, 63, 36, 33
};

static int tdm_seq_60[64] = {
    34, 36, 38, 10,
    34, 36, 39, 11,
     2, 18, 40, 12,
    34, 36, 40, 13,
    34, 36, 38, 14,
     3, 19, 39, 15,
    34, 36, 40, 16,
    34, 36, 40, 17,
     4, 20, 38, 26,
    34, 36, 39, 27,
    34, 36, 40, 28,
     5, 21, 40, 29,
    34, 36, 38, 30,
     0, 63, 39, 31,
    34, 36, 40, 32,
    63, 63, 40, 33
};

static int tdm_seq_7[68] = {
    34, 38,  2, 18,
    34, 38, 10, 26,
    34, 38,  3, 19,
    34, 38, 11, 27,
    34, 38,  4, 20,
    34, 38, 12, 28,
    34, 38,  5, 21,
    34, 38, 13, 29,
    34, 38,  2, 18,
    34, 38, 14, 30,
    34, 38,  3, 19,
    34, 38, 15, 31,
    34, 38,  4, 20,
    34, 38, 16, 32,
    34, 38,  5, 21,
    34, 38, 17, 33,
    34, 38,  0, 63
};

static int tdm_seq_8[80] = {
    38, 34, 36, 18,
    38, 34, 36, 26,
    38, 34, 36, 19,
    38, 34,  2, 27,
    38, 36, 10, 20,
    38, 34,  3, 28,
    38, 36, 11, 21,
    38, 34,  4, 29,
    38, 36, 12, 18,
    38, 34,  5, 30,
    38, 36, 13, 19,
    38, 34, 36,  2,
    38, 34, 36, 14,
    38, 34, 36, 31,
    38, 34,  3, 20,
    38, 36, 15, 32,
    38, 34,  4, 21,
    38, 36, 16, 33,
    38, 34,  5,  0,
    38, 36, 17, 63
};

static int tdm_seq_80[80] = {
    34, 38, 40, 18,
    34, 38, 40, 26,
    34, 38, 40, 19,
    34, 38,  2, 27,
    34, 40, 10, 20,
    34, 38,  3, 28,
    34, 40, 11, 21,
    34, 38,  4, 29,
    34, 40, 12, 18,
    34, 38,  5, 30,
    34, 40, 13, 19,
    34, 38, 40,  2,
    34, 38, 40, 14,
    34, 38, 40, 31,
    34, 38,  3, 20,
    34, 40, 15, 32,
    34, 38,  4, 21,
    34, 40, 16, 33,
    34, 38,  5,  0,
    34, 40, 17, 63
};

static int tdm_seq_9[64] = {
    38, 40, 34, 10, 
    38, 40, 34, 11,
     2, 18, 36, 12, 
    38, 40, 36, 13,
    38, 40, 34, 14, 
     3, 19, 34, 15,
    38, 40, 36, 16, 
    38, 40, 36, 17,
     4, 20, 34, 26,
    38, 40, 34, 27, 
    38, 40, 36, 28,
     5, 21, 36, 29, 
    38, 40, 34, 30,
     0, 63, 34, 31, 
    38, 40, 36, 32,
    63, 63, 36, 33, 
};

static int tdm_seq_90[64] = {
    34, 36, 38, 10, 
    34, 36, 38, 11,
     2, 18, 40, 12, 
    34, 36, 40, 13,
    34, 36, 38, 14, 
     3, 19, 38, 15,
    34, 36, 40, 16, 
    34, 36, 40, 17,
     4, 20, 38, 26,
    34, 36, 38, 27, 
    34, 36, 40, 28,
     5, 21, 40, 29, 
    34, 36, 38, 30,
     0, 63, 38, 31, 
    34, 36, 40, 32,
    63, 63, 40, 33, 
};

static int tdm_seq_1001[50] = {
    38, 36,  7, 22,
    39, 37, 34, 26,
     2, 18, 35, 27,
    38, 36,  8, 23,
    39, 37, 34, 28,
     3, 19, 35, 29,
    38, 36,  9, 24,
    39, 37, 34, 30,
     4, 20, 35, 31,
    38, 36,  6, 25,
    39, 37, 34, 32,
     5, 21, 35, 33,
     0, 63
};

static int tdm_seq_1010[50] = {
    38, 40,  7, 22,
    39, 41, 34, 26,
     2, 18, 35, 27,
    38, 40,  8, 23,
    39, 41, 34, 28,
     3, 19, 35, 29,
    38, 40,  9, 24,
    39, 41, 34, 30,
     4, 20, 35, 31,
    38, 40,  6, 25,
    39, 41, 34, 32,
     5, 21, 35, 33,
     0, 63
};

static int tdm_seq_1002[64] = {
    38, 40, 34,  6,
    38, 40, 35,  7,
     0, 18, 36,  8,
    38, 40, 37,  9,
    38, 40, 34, 26,
     3, 19, 35, 27,
    38, 40, 36, 28,
    38, 40, 37, 29,
     4, 20, 34, 30,
    38, 40, 35, 31,
    38, 40, 36, 32,
     5, 21, 37, 33,
    38, 40, 34, 22,
     2, 63, 35, 23,
    38, 40, 36, 24,
    63, 63, 37, 25
};

static int tdm_seq_1020[64] = {
    34, 36, 38,  6,
    34, 36, 39,  7,
     0, 18, 40,  8,
    34, 36, 41,  9,
    34, 36, 38, 26,
     3, 19, 39, 27,
    34, 36, 40, 28,
    34, 36, 41, 29,
     4, 20, 38, 30,
    34, 36, 39, 31,
    34, 36, 40, 32,
     5, 21, 41, 33,
    34, 36, 38, 22,
     2, 63, 39, 23,
    34, 36, 40, 24,
    63, 63, 41, 25
};

/* the same as 1001 */
static int tdm_seq_1003[50] = {
    38, 36,  7, 22,
    39, 37, 34, 26,
     2, 18, 35, 27,
    38, 36,  8, 23,
    39, 37, 34, 28,
     3, 19, 35, 29,
    38, 36,  9, 24,
    39, 37, 34, 30,
     4, 20, 35, 31,
    38, 36,  6, 25,
    39, 37, 34, 32,
     5, 21, 35, 33,
     0, 63
};

/* the same as 1001 */
static int tdm_seq_1004[50] = {
    38, 36,  7, 22,
    39, 37, 34, 26,
     2, 18, 35, 27,
    38, 36,  8, 23,
    39, 37, 34, 28,
     3, 19, 35, 29,
    38, 36,  9, 24,
    39, 37, 34, 30,
     4, 20, 35, 31,
    38, 36,  6, 25,
    39, 37, 34, 32,
     5, 21, 35, 33,
     0, 63
};

static int tdm_seq_1005[66] = {
    36, 34, 38,  2,
    40, 35, 39,  3,
    36, 22, 26,  4,
    40, 23, 27,  5,
    36, 34, 38, 18,
    40, 35, 39, 19,
    36,  8, 28, 20,
    40,  9, 29, 21,
    36, 34, 38,  2,
    40, 35, 39,  3,
    36, 24, 30,  4,
    40, 25, 31,  5,
    36, 34, 38, 18,
    40, 35, 39, 19,
    36,  6, 32, 20,
    40,  7, 33, 21,
     0, 63
};

static int tdm_seq_1006[64] = {
    38, 40, 34,  6,
    38, 40, 35,  7,
     0, 18, 36,  8,
    38, 40, 36,  9,
    38, 40, 34, 26,
     3, 19, 35, 27,
    38, 40, 36, 28,
    38, 40, 36, 29,
     4, 20, 34, 30,
    38, 40, 35, 31,
    38, 40, 36, 32,
     5, 21, 36, 33,
    38, 40, 34, 22,
     2, 63, 35, 23,
    38, 40, 36, 24,
    63, 63, 36, 25
};

static int tdm_seq_1060[64] = {
    34, 36, 38,  6,
    34, 36, 39,  7,
     0, 18, 40,  8,
    34, 36, 40,  9,
    34, 36, 38, 26,
     3, 19, 39, 27,
    34, 36, 40, 28,
    34, 36, 40, 29,
     4, 20, 38, 30,
    34, 36, 39, 31,
    34, 36, 40, 32,
     5, 21, 40, 33,
    34, 36, 38, 22,
     2, 63, 39, 23,
    34, 36, 40, 24,
    63, 63, 40, 25
};

static int tdm_seq_1007[68] = {
    34, 38,  2, 18,
    34, 38,  6, 26,
    34, 38,  3, 19,
    34, 38,  7, 27,
    34, 38,  4, 20,
    34, 38,  8, 28,
    34, 38,  5, 21,
    34, 38,  9, 29,
    34, 38,  2, 18,
    34, 38, 30, 22,
    34, 38,  3, 19,
    34, 38, 31, 23,
    34, 38,  4, 20,
    34, 38, 32, 24,
    34, 38,  5, 21,
    34, 38, 33, 25,
    34, 38,  0, 63
};

static int tdm_seq_1008[80] = {
    38, 34, 36, 18,
    38, 34, 36, 26,
    38, 34, 36, 19,
    38, 34,  2, 27,
    38, 36,  6, 20,
    38, 34,  3, 28,
    38, 36,  7, 21,
    38, 34,  4, 29,
    38, 36,  8, 18,
    38, 34,  5, 30,
    38, 36,  9, 19,
    38, 34, 36,  2,
    38, 34, 36, 22,
    38, 34, 36, 31,
    38, 34,  3, 20,
    38, 36, 32, 23,
    38, 34,  4, 21,
    38, 36, 33, 24,
    38, 34,  5,  0,
    38, 36, 63, 25
};

static int tdm_seq_1080[80] = {
    34, 38, 40, 18,
    34, 38, 40, 26,
    34, 38, 40, 19,
    34, 38,  2, 27,
    34, 40,  6, 20,
    34, 38,  3, 28,
    34, 40,  7, 21,
    34, 38,  4, 29,
    34, 40,  8, 18,
    34, 38,  5, 30,
    34, 40,  9, 19,
    34, 38, 40,  2,
    34, 38, 40, 22,
    34, 38, 40, 31,
    34, 38,  3, 20,
    34, 40, 32, 23,
    34, 38,  4, 21,
    34, 40, 33, 24,
    34, 38,  5,  0,
    34, 40, 63, 25
};

static int tdm_seq_1009[64] = {
     38, 40, 34,  6, 
     38, 40, 34,  7,
      0, 18, 36,  8, 
     38, 40, 36,  9,
     38, 40, 34, 26, 
      3, 19, 34, 27,
     38, 40, 36, 28, 
     38, 40, 36, 29,
      4, 20, 34, 30,
     38, 40, 34, 31, 
     38, 40, 36, 32,
      5, 21, 36, 33, 
     38, 40, 34, 22,
      2, 63, 34, 23, 
     38, 40, 36, 24,
     63, 63, 36, 25, 
};

static int tdm_seq_1090[64] = {
     34, 36, 38,  6, 
     34, 36, 38,  7,
      0, 18, 40,  8, 
     34, 36, 40,  9,
     34, 36, 38, 26, 
      3, 19, 38, 27,
     34, 36, 40, 28, 
     34, 36, 40, 29,
      4, 20, 38, 30,
     34, 36, 38, 31, 
     34, 36, 40, 32,
      5, 21, 40, 33, 
     34, 36, 38, 22,
      2, 63, 38, 23, 
     34, 36, 40, 24,
     63, 63, 40, 25, 
};

static int tdm_seq_11[34] = {
    10, 18, 26, 34,
    11, 19, 27, 35,
    12, 20, 28, 36,
    13, 21, 29, 37,
    14, 22, 30, 34,
    15, 23, 31, 35,
    16, 24, 32, 36,
    17, 25, 33, 37,
     0, 63
};

static int tdm_seq_110[34] = {
    10, 18, 26, 38,
    11, 19, 27, 39,
    12, 20, 28, 40,
    13, 21, 29, 41,
    14, 22, 30, 38,
    15, 23, 31, 39,
    16, 24, 32, 40,
    17, 25, 33, 41,
     0, 63
};

static int tdm_seq_12[54] = {
    38, 40, 10, 34,
    38, 40, 11, 35,
    38, 40, 12, 31,
    38, 40, 13, 32,
    38, 40, 14, 33,
    38, 40, 15, 18,
    38, 40, 16, 19,
    38, 40, 17, 20,
    38, 40, 26, 21,
    38, 40, 27, 22,
    38, 40, 28, 23,
    38, 40, 29, 24,
    38, 40, 30, 25,
     0, 63
};

static int tdm_seq_1011[34] = {
     2, 18, 26, 34,
     3, 19, 27, 35,
     4, 20, 28, 36,
     5, 21, 29, 37,
     6, 22, 30, 34,
     7, 23, 31, 35,
     8, 24, 32, 36,
     9, 25, 33, 37,
     0, 63
};

static int tdm_seq_1110[34] = {
     2, 18, 26, 38,
     3, 19, 27, 39,
     4, 20, 28, 40,
     5, 21, 29, 41,
     6, 22, 30, 38,
     7, 23, 31, 39,
     8, 24, 32, 40,
     9, 25, 33, 41,
     0, 63
};

static int tdm_seq_1012[54] = {
    38, 40,  2, 34,
    38, 40,  3, 35,
    38, 40,  4, 31,
    38, 40,  5, 32,
    38, 40,  6, 33,
    38, 40,  7, 18,
    38, 40,  8, 19,
    38, 40,  9, 20,
    38, 40, 26, 21,
    38, 40, 27, 22,
    38, 40, 28, 23,
    38, 40, 29, 24,
    38, 40, 30, 25,
     0, 63
};

static int tdm_seq_21[32] = {
    34, 38,  0, 10,
    34, 38, 63, 11,
    34, 38, 63, 12,
    34, 38, 63, 13,
    34, 38, 63, 14,
    34, 38, 63, 15,
    34, 38, 63, 16,
    34, 38, 63, 17
};

static int tdm_seq_22[32] = {
    34, 38,  0, 10,
    35, 39, 63, 11,
    36, 40, 63, 12,
    37, 41, 63, 13,
    34, 38, 63, 14,
    35, 39, 63, 15,
    36, 40, 63, 16,
    37, 41, 63, 17
};

static int tdm_seq_23[32] = {
    34, 38,  0, 10,
    34, 38, 63, 11,
    34, 38, 63, 12,
    34, 38, 63, 13,
    34, 38, 63, 14,
    34, 38, 63, 15,
    34, 38, 63, 16,
    34, 38, 63, 17
};

static int tdm_seq_1021[32] = {
    34, 38,  0,  2,
    34, 38, 63,  3,
    34, 38, 63,  4,
    34, 38, 63,  5,
    34, 38, 63, 18,
    34, 38, 63, 19,
    34, 38, 63, 20,
    34, 38, 63, 21
};

static int tdm_seq_1022[32] = {
    34, 38,  0,  2,
    35, 39, 63,  3,
    36, 40, 63,  4,
    37, 41, 63,  5,
    34, 38, 63, 18,
    35, 39, 63, 19,
    36, 40, 63, 20,
    37, 41, 63, 21
};
/* the same as 1021 */
static int tdm_seq_1023[32] = {
    34, 38,  0,  2,
    34, 38, 63,  3,
    34, 38, 63,  4,
    34, 38, 63,  5,
    34, 38, 63, 18,
    34, 38, 63, 19,
    34, 38, 63, 20,
    34, 38, 63, 21
};

static int tdm_seq_31[86] = {
    38, 36, 34, 18,
    39, 37, 35, 19,
    38, 36, 34, 20,
    39, 37, 35, 21,
    38, 36, 34, 22,
    39, 37, 35, 23,
    38, 36, 34, 24,
    39, 37, 35, 26,
    38, 36, 34, 27,
    39, 37, 35, 28,
    38, 36, 34, 29,
    39, 37, 35, 30,
    38, 36, 34, 31,
    39, 37, 35, 10,
    38, 36, 34, 11,
    39, 37, 35, 12,
    38, 36, 34, 13,
    39, 37, 35, 14,
    38, 36, 34, 15,
    39, 37, 32, 16,
    35, 25, 33, 17,
    0, 63
};

static int tdm_seq_310[86] = {
    38, 40, 34, 18,
    39, 41, 35, 19,
    38, 40, 34, 20,
    39, 41, 35, 21,
    38, 40, 34, 22,
    39, 41, 35, 23,
    38, 40, 34, 24,
    39, 41, 35, 26,
    38, 40, 34, 27,
    39, 41, 35, 28,
    38, 40, 34, 29,
    39, 41, 35, 30,
    38, 40, 34, 31,
    39, 41, 35, 10,
    38, 40, 34, 11,
    39, 41, 35, 12,
    38, 40, 34, 13,
    39, 41, 35, 14,
    38, 40, 34, 15,
    39, 41, 32, 16,
    35, 25, 33, 17,
    0, 63
};

static int tdm_seq_32[96] = {
    38, 40, 34, 10,
    38, 40, 35, 11,
    38, 40, 34, 12,
    38, 40, 35, 13,
    38, 40, 34, 14,
    38, 40, 35, 15,
    38, 40, 34, 16,
    38, 40, 35, 17,
    38, 40, 34, 18,
    38, 40, 35, 19,
    38, 40, 34, 20,
    38, 40, 35, 21,
    38, 40, 34, 22,
    38, 40, 35, 23,
    38, 40, 34, 24,
    38, 40, 35, 25,
    38, 40, 34, 26,
    38, 40, 35, 27,
    38, 40, 34, 28,
    38, 40, 35, 29,
    38, 40,  0, 30,
    38, 40, 34, 31,
    38, 40, 35, 32,
    38, 40, 63, 33
};

static int tdm_seq_320[96] = {
    34, 36, 38, 10,
    34, 36, 39, 11,
    34, 36, 38, 12,
    34, 36, 39, 13,
    34, 36, 38, 14,
    34, 36, 39, 15,
    34, 36, 38, 16,
    34, 36, 39, 17,
    34, 36, 38, 18,
    34, 36, 39, 19,
    34, 36, 38, 20,
    34, 36, 39, 21,
    34, 36, 38, 22,
    34, 36, 39, 23,
    34, 36, 38, 24,
    34, 36, 39, 25,
    34, 36, 38, 26,
    34, 36, 39, 27,
    34, 36, 38, 28,
    34, 36, 39, 29,
    34, 36,  0, 30,
    34, 36, 38, 31,
    34, 36, 39, 32,
    34, 36, 63, 33
};

/* Same as tdm_seq_31 */
static int tdm_seq_33[86] = {
    38, 36, 34, 18,
    39, 37, 35, 19,
    38, 36, 34, 20,
    39, 37, 35, 21,
    38, 36, 34, 22,
    39, 37, 35, 23,
    38, 36, 34, 24,
    39, 37, 35, 26,
    38, 36, 34, 27,
    39, 37, 35, 28,
    38, 36, 34, 29,
    39, 37, 35, 30,
    38, 36, 34, 31,
    39, 37, 35, 10,
    38, 36, 34, 11,
    39, 37, 35, 12,
    38, 36, 34, 13,
    39, 37, 35, 14,
    38, 36, 34, 15,
    39, 37, 32, 16,
    35, 25, 33, 17,
    0, 63
};

/* Same as tdm_seq_31 */
static int tdm_seq_34[86] = {
    38, 36, 34, 18,
    39, 37, 35, 19,
    38, 36, 34, 20,
    39, 37, 35, 21,
    38, 36, 34, 22,
    39, 37, 35, 23,
    38, 36, 34, 24,
    39, 37, 35, 26,
    38, 36, 34, 27,
    39, 37, 35, 28,
    38, 36, 34, 29,
    39, 37, 35, 30,
    38, 36, 34, 31,
    39, 37, 35, 10,
    38, 36, 34, 11,
    39, 37, 35, 12,
    38, 36, 34, 13,
    39, 37, 35, 14,
    38, 36, 34, 15,
    39, 37, 32, 16,
    35, 25, 33, 17,
    0, 63
};

static int tdm_seq_35[86] = {
    36, 40, 34, 19,
    36, 40, 38, 20,
    36, 40, 34, 21,
    36, 40, 38, 22,
    36, 40, 34, 23,
    36, 40, 38, 24,
    36, 40, 34, 25,
    36, 40, 38, 26,
    36, 40, 34, 27,
    36, 40, 38, 28,
    18, 17,  0, 29,
    36, 40, 34, 30,
    36, 40, 38, 31,
    36, 40, 34, 32,
    36, 40, 38, 10,
    36, 40, 34, 11,
    36, 40, 38, 12,
    36, 40, 34, 13,
    36, 40, 38, 14,
    36, 40, 34, 15,
    36, 40, 38, 16,
    33, 63
};

static int tdm_seq_36[92] = {
    38, 40, 36, 13,
    38, 40, 36, 14,
    38, 40, 36, 34,
    38, 40, 36, 26,
    10, 40, 18, 34,
    38, 40, 36, 27,
    38, 40, 36, 15,
    38, 40, 19, 34,
    38, 40, 36, 28,
    11,  0, 20, 34,
    38, 40, 36, 16,
    38, 40, 36, 29,
    38, 40, 21, 34,
    38, 40, 36, 30,
    12, 63, 22, 34,
    38, 40, 36, 31,
    38, 40, 36, 32,
    38, 40, 23, 34,
    38, 40, 36, 17,
    38, 63, 24, 34,
    38, 40, 36, 33,
    38, 40, 36, 34,
    38, 40, 36, 25
};

static int tdm_seq_1031[86] = {
    38, 36, 34, 18,
    39, 37, 35, 19,
    38, 36, 34, 20,
    39, 37, 35, 21,
    38, 36, 34, 22,
    39, 37, 35, 23,
    38, 36, 34, 24,
    39, 37, 35, 26,
    38, 36, 34, 27,
    39, 37, 35, 28,
    38, 36, 34, 29,
    39, 37, 35, 30,
    38, 36, 34, 31,
    39, 37, 35,  2,
    38, 36, 34,  3,
    39, 37, 35,  4,
    38, 36, 34,  5,
    39, 37, 35,  6,
    38, 36, 34,  7,
    39, 37, 32,  8,
    35, 25, 33,  9,
    0, 63
};

static int tdm_seq_1310[86] = {
    38, 40, 34, 18,
    39, 41, 35, 19,
    38, 40, 34, 20,
    39, 41, 35, 21,
    38, 40, 34, 22,
    39, 41, 35, 23,
    38, 40, 34, 24,
    39, 41, 35, 26,
    38, 40, 34, 27,
    39, 41, 35, 28,
    38, 40, 34, 29,
    39, 41, 35, 30,
    38, 40, 34, 31,
    39, 41, 35,  2,
    38, 40, 34,  3,
    39, 41, 35,  4,
    38, 40, 34,  5,
    39, 41, 35,  6,
    38, 40, 34,  7,
    39, 41, 32,  8,
    35, 25, 33,  9,
    0, 63
};

static int tdm_seq_1032[96] = {
    38, 40, 34,  2,
    38, 40, 35,  3,
    38, 40, 34,  4,
    38, 40, 35,  5,
    38, 40, 34,  6,
    38, 40, 35,  7,
    38, 40, 34,  8,
    38, 40, 35,  9,
    38, 40, 34, 18,
    38, 40, 35, 19,
    38, 40, 34, 20,
    38, 40, 35, 21,
    38, 40, 34, 22,
    38, 40, 35, 23,
    38, 40, 34, 24,
    38, 40, 35, 25,
    38, 40, 34, 26,
    38, 40, 35, 27,
    38, 40, 34, 28,
    38, 40, 35, 29,
    38, 40,  0, 30,
    38, 40, 34, 31,
    38, 40, 35, 32,
    38, 40, 63, 33
};

static int tdm_seq_1320[96] = {
    34, 36, 38,  2,
    34, 36, 39,  3,
    34, 36, 38,  4,
    34, 36, 39,  5,
    34, 36, 38,  6,
    34, 36, 39,  7,
    34, 36, 38,  8,
    34, 36, 39,  9,
    34, 36, 38, 18,
    34, 36, 39, 19,
    34, 36, 38, 20,
    34, 36, 39, 21,
    34, 36, 38, 22,
    34, 36, 39, 23,
    34, 36, 38, 24,
    34, 36, 39, 25,
    34, 36, 38, 26,
    34, 36, 39, 27,
    34, 36, 38, 28,
    34, 36, 39, 29,
    34, 36,  0, 30,
    34, 36, 38, 31,
    34, 36, 39, 32,
    34, 36, 63, 33
};

/* the same as 1031 */
static int tdm_seq_1033[86] = {
    38, 36, 34, 18,
    39, 37, 35, 19,
    38, 36, 34, 20,
    39, 37, 35, 21,
    38, 36, 34, 22,
    39, 37, 35, 23,
    38, 36, 34, 24,
    39, 37, 35, 26,
    38, 36, 34, 27,
    39, 37, 35, 28,
    38, 36, 34, 29,
    39, 37, 35, 30,
    38, 36, 34, 31,
    39, 37, 35,  2,
    38, 36, 34,  3,
    39, 37, 35,  4,
    38, 36, 34,  5,
    39, 37, 35,  6,
    38, 36, 34,  7,
    39, 37, 32,  8,
    35, 25, 33,  9,
    0, 63
};

/* the same as 1031 */
static int tdm_seq_1034[86] = {
    38, 36, 34, 18,
    39, 37, 35, 19,
    38, 36, 34, 20,
    39, 37, 35, 21,
    38, 36, 34, 22,
    39, 37, 35, 23,
    38, 36, 34, 24,
    39, 37, 35, 26,
    38, 36, 34, 27,
    39, 37, 35, 28,
    38, 36, 34, 29,
    39, 37, 35, 30,
    38, 36, 34, 31,
    39, 37, 35,  2,
    38, 36, 34,  3,
    39, 37, 35,  4,
    38, 36, 34,  5,
    39, 37, 35,  6,
    38, 36, 34,  7,
    39, 37, 32,  8,
    35, 25, 33,  9,
    0, 63
};

static int tdm_seq_1035[86] = {
    36, 40, 34, 19,
    36, 40, 38, 20,
    36, 40, 34, 21,
    36, 40, 38, 22,
    36, 40, 34, 23,
    36, 40, 38, 24,
    36, 40, 34, 25,
    36, 40, 38, 26,
    36, 40, 34, 27,
    36, 40, 38, 28,
    18,  9,  0, 29,
    36, 40, 34, 30,
    36, 40, 38, 31,
    36, 40, 34, 32,
    36, 40, 38,  2,
    36, 40, 34,  3,
    36, 40, 38,  4,
    36, 40, 34,  5,
    36, 40, 38,  6,
    36, 40, 34,  7,
    36, 40, 38,  8,
    33, 63
};

static int tdm_seq_1036[92] = {
    38, 40, 36,  5,
    38, 40, 36,  6,
    38, 40, 36, 34,
    38, 40, 36, 26,
     2, 40, 18, 34,
    38, 40, 36, 27,
    38, 40, 36,  7,
    38, 40, 19, 34,
    38, 40, 36, 28,
     3,  0, 20, 34,
    38, 40, 36,  8,
    38, 40, 36, 29,
    38, 40, 21, 34,
    38, 40, 36, 30,
     4, 63, 22, 34,
    38, 40, 36, 31,
    38, 40, 36, 32,
    38, 40, 23, 34,
    38, 40, 36,  9,
    38, 63, 24, 34,
    38, 40, 36, 33,
    38, 40, 36, 34,
    38, 40, 36, 25
};

static int tdm_seq_43[50] = {
    38, 36, 34, 12,
    39, 40, 35, 13,
     2, 18, 26, 14,
    38, 36, 34, 15,
    39, 40, 35, 16,
     3, 19, 27, 17,
    38, 36, 34, 28,
    39, 40, 35, 29,
     4, 20, 10, 30,
    38, 36, 34, 31,
    39, 40, 35, 32,
     5, 21, 11, 33,
     0, 63
};

/* Same as tdm_seq_20 */
static int tdm_seq_44[64] = {
    34, 36, 38, 10,
    34, 36, 39, 11,
     2, 18, 40, 12,
    34, 36, 41, 13,
    34, 36, 38, 14,
     3, 19, 39, 15,
    34, 36, 40, 16,
    34, 36, 41, 17,
     4, 20, 38, 26,
    34, 36, 39, 27,
    34, 36, 40, 28,
     5, 21, 41, 29,
    34, 36, 38, 30,
     0, 63, 39, 31,
    34, 36, 40, 32,
    63, 63, 41, 33
};

/* Same as tdm_seq_2 */
static int tdm_seq_440[64] = {
    38, 40, 34, 10,
    38, 40, 35, 11,
     2, 18, 36, 12,
    38, 40, 37, 13,
    38, 40, 34, 14,
     3, 19, 35, 15,
    38, 40, 36, 16,
    38, 40, 37, 17,
     4, 20, 34, 26,
    38, 40, 35, 27,
    38, 40, 36, 28,
     5, 21, 37, 29,
    38, 40, 34, 30,
     0, 63, 35, 31,
    38, 40, 36, 32,
    63, 63, 37, 33
};

static int tdm_seq_1043[50] = {
    38, 40,  7, 22,
    39, 36, 34, 26,
     2, 18, 35, 27,
    38, 40,  8, 23,
    39, 36, 34, 28,
     3, 19, 35, 29,
    38, 40,  9, 24,
    39, 36, 34, 30,
     4, 20, 35, 31,
    38, 40,  6, 25,
    39, 36, 34, 32,
     5, 21, 35, 33,
     0, 63
};

/* the same as 1020 */
static int tdm_seq_1044[64] = {
    34, 36, 38,  6,
    34, 36, 39,  7,
     0, 18, 40,  8,
    34, 36, 41,  9,
    34, 36, 38, 26,
     3, 19, 39, 27,
    34, 36, 40, 28,
    34, 36, 41, 29,
     4, 20, 38, 30,
    34, 36, 39, 31,
    34, 36, 40, 32,
     5, 21, 41, 33,
    34, 36, 38, 22,
     2, 63, 39, 23,
    34, 36, 40, 24,
    63, 63, 41, 25
};

/* the same as 1002 */
static int tdm_seq_1440[64] = {
    38, 40, 34,  6,
    38, 40, 35,  7,
     0, 18, 36,  8,
    38, 40, 37,  9,
    38, 40, 34, 26,
     3, 19, 35, 27,
    38, 40, 36, 28,
    38, 40, 37, 29,
     4, 20, 34, 30,
    38, 40, 35, 31,
    38, 40, 36, 32,
     5, 21, 37, 33,
    38, 40, 34, 22,
     2, 63, 35, 23,
    38, 40, 36, 24,
    63, 63, 37, 25
};
  
/* Same as tdm_seq_11 */
static int tdm_seq_51[34] = {
    10, 18, 26, 34,
    11, 19, 27, 35,
    12, 20, 28, 36,
    13, 21, 29, 37,
    14, 22, 30, 34,
    15, 23, 31, 35,
    16, 24, 32, 36,
    17, 25, 33, 37,
     0, 63
};

#define _CFG_MAP(_cfg) { COUNTOF(_cfg), _cfg }
typedef struct _cfg_map_s {
    int size;
    int *val;
} _cfg_map_t;

#define _PORT_CFGS(_id) { \
    _id, \
    _CFG_MAP(p2l_mapping_##_id), \
    _CFG_MAP(port_speed_max_##_id), \
    _CFG_MAP(tdm_seq_##_id) \
}

typedef struct _port_cfg_s {
    uint32_t id;
    _cfg_map_t p2l;
    _cfg_map_t speed_max;
    _cfg_map_t tdm;
} _port_cfg_t;

static _port_cfg_t _port_cfgs[] = {
    _PORT_CFGS(1),
    _PORT_CFGS(10),
    _PORT_CFGS(2),
    _PORT_CFGS(20),
    _PORT_CFGS(3),
    _PORT_CFGS(4),
    _PORT_CFGS(5),
    _PORT_CFGS(6),
    _PORT_CFGS(60),
    _PORT_CFGS(7),
    _PORT_CFGS(8),
    _PORT_CFGS(80),
    _PORT_CFGS(9),
    _PORT_CFGS(90),    
    _PORT_CFGS(1001),
    _PORT_CFGS(1010),
    _PORT_CFGS(1002),
    _PORT_CFGS(1020),
    _PORT_CFGS(1003),
    _PORT_CFGS(1004),
    _PORT_CFGS(1005),
    _PORT_CFGS(1006),
    _PORT_CFGS(1060),
    _PORT_CFGS(1007),
    _PORT_CFGS(1008),
    _PORT_CFGS(1080),
    _PORT_CFGS(1009),
    _PORT_CFGS(1090),      
    _PORT_CFGS(11),
    _PORT_CFGS(110),
    _PORT_CFGS(12),
    _PORT_CFGS(1011),    
    _PORT_CFGS(1110),     
    _PORT_CFGS(1012),    
    _PORT_CFGS(21),
    _PORT_CFGS(22),
    _PORT_CFGS(23),
    _PORT_CFGS(1021),
    _PORT_CFGS(1022),
    _PORT_CFGS(1023),    
    _PORT_CFGS(31),
    _PORT_CFGS(310),
    _PORT_CFGS(32),
    _PORT_CFGS(320),
    _PORT_CFGS(33),
    _PORT_CFGS(34),
    _PORT_CFGS(35),
    _PORT_CFGS(36),
    _PORT_CFGS(1031),
    _PORT_CFGS(1310),
    _PORT_CFGS(1032),
    _PORT_CFGS(1320),
    _PORT_CFGS(1033),
    _PORT_CFGS(1034),
    _PORT_CFGS(1035),
    _PORT_CFGS(1036),
    _PORT_CFGS(43),
    _PORT_CFGS(44),
    _PORT_CFGS(440),
    _PORT_CFGS(1043),
    _PORT_CFGS(1044),
    _PORT_CFGS(1440),
    _PORT_CFGS(51),
};

/* 
 * Table to translate between external (PRD) and internal port
 * configuration IDs.
 */
static struct _port_cfg_xlate_s {
    int count;
    int cfg_opt[30];   /* Port configuration options as per PRD */
    int cfg_id[30];    /* Internal port configuration IDs */
} _port_cfg_xlate[] = {
    /* 0, QTC25G, TSC40G */
    {14, {0x1, 0x1A, 0x2, 0x2A, 0x3, 0x4, 0x5, 0x6, 0x6A, 0x7, 0x8, 0x8A, 0x9, 
          0x9A},
         {  1,   10,   2,   20,   3,   4,   5,   6,   60,   7,   8,   80, 9, 90}},
    /* 1, TSC13G */
    { 3, {0x1, 0x1A, 0x2},
         { 11,  110,  12}},
    /* 2, SGMII_ONLY */
    { 3, {0x1, 0x2, 0x3},
         { 21,  22,  23}},
    /* 3, NO_TSC1 */
    { 1, {0x1}, {11}},
    /* 4 */
    { 8, {0x1, 0x1A, 0x2, 0x2A, 0x3, 0x4, 0x5, 0x6},
         { 31,  310,  32,  320,  33,  34,  35,  36}},
    /* 5, QTC25G */
    { 12, {0x1, 0x2, 0x2A, 0x3, 0x4, 0x4A, 0x5, 0x6, 0x7, 0x7A, 0x8, 0x8A},
         {  5,  60,    6,  43,  44,  440,   3,   4,   1,   10,   2,   20}},
    /* 6, NO_TSC */
    { 1, {0x1}, {51}}
};

static struct _support_qtc_mode_s {
    int qsgmii_num[QTC_MAX_BLK_COUNT];
    int sgmii_num[QTC_MAX_BLK_COUNT];
} _support_qtc_mode[] = {
    {{1, 1}, {4, 4}},   /* 24P_GPHY_2.5G */
    {{0, 2}, {0, 2}}    /* 24P_GPHY_1G */
};

static int _pcfg_idx[BMD_CONFIG_MAX_UNITS];

static const int tsc_phy_port[TSC_MAX_BLK_COUNT] = {34, 38};
static const int qtc_phy_port[QTC_MAX_BLK_COUNT] = {2, 18};
static const int qgphy_port[QGPHY_MAX_BLK_COUNT] = {10, 26};

/*
 * Unused SerDes cores can be disabled through H/W pin strapping.
 * This table tracks which ports have been disabled this way.
 */
static int _serdes_disabled[NUM_PHYS_PORTS] = { 0 };


#if CDK_CONFIG_INCLUDE_PORT_MAP == 1
static struct _port_map_s {
    cdk_port_map_port_t map[BMD_CONFIG_MAX_PORTS];
} _port_map[BMD_CONFIG_MAX_UNITS];

static void
_init_port_map(int unit)
{
    cdk_pbmp_t gpbmp, xlpbmp;
    int port, idx, pidx = 0;
    int blk;

    CDK_MEMSET(&_port_map[unit], -1, sizeof(_port_map[unit]));

    _port_map[unit].map[pidx] = CMIC_PORT;

    bcm56160_a0_gport_pbmp_get(unit, &gpbmp);
    for (idx = 2; idx < 34; idx++) {
        blk = (idx - 2) >> 3;
        if (blk == 1) {
            port = 27 - idx;
        } else if (blk == 2) {
            port = idx + 8;
        } else if (blk == 3) {
            port = idx - 8;
        } else {
            port = idx;
        }

        if (CDK_PBMP_MEMBER(gpbmp, port)) {
            pidx++;
            _port_map[unit].map[pidx] = port;
        }
    }

    bcm56160_a0_xlport_pbmp_get(unit, &xlpbmp);
    CDK_PBMP_ITER(xlpbmp, port) {
        pidx++;
        _port_map[unit].map[pidx] = port;
    }
    CDK_PORT_MAP_SET(unit, _port_map[unit].map, pidx + 1);
}
#endif /* CDK_CONFIG_INCLUDE_PORT_MAP */

static void
_sgmii_mode_enable(int unit)
{
    int lport;
    int qidx, bidx, idx, tmp;
    int qtc_mode;
    _cfg_map_t *p2l_map = &_port_cfgs[_pcfg_idx[unit]].p2l;
    _cfg_map_t *speed_map = &_port_cfgs[_pcfg_idx[unit]].speed_max;

    /*
     * Get qtc_mode that is used to get the QSGMII and SGMII support
     * number from _support_qtc_mode[] table.
     */
    qtc_mode = 1;
    if (CDK_XGSD_FLAGS(unit) & CHIP_FLAG_QTC25G) {
        qtc_mode = 0;
    }

    for (qidx = 0; qidx < QTC_MAX_BLK_COUNT; qidx++) {
        /* Disable QSGMII ports */
        tmp = _support_qtc_mode[qtc_mode].qsgmii_num[qidx];
        for (bidx = 0; bidx < tmp; bidx++) {
            for (idx = 0; idx < 4; idx++) {
                p2l_map->val[qtc_phy_port[qidx] + (bidx * 4) + idx] = -1;
                speed_map->val[qtc_phy_port[qidx] + (bidx * 4) + idx] = -1;
            }
        }

        /* Enable SGMII ports */
        tmp = _support_qtc_mode[qtc_mode].sgmii_num[qidx];
        for (bidx = 0; bidx < tmp; bidx++) {
            p2l_map->val[qtc_phy_port[qidx] + bidx] = 1;
            speed_map->val[qtc_phy_port[qidx] + bidx] = 10;
            if (CDK_XGSD_FLAGS(unit) & CHIP_FLAG_QTC25G) {
                speed_map->val[qtc_phy_port[qidx] + bidx] = 25;
            }
        }
    }

    lport = 2;
    for (idx = 0; idx < NUM_PHYS_PORTS; idx++) {
        if (p2l_map->val[idx] > 0) {
            p2l_map->val[idx] = lport;
            lport++;
        }
    }
}

/*
 * This function is called after the chip is out of reset and
 * the H/W pin strapping has been read from a chip register.
 * Port mappings and port properties will be adjusted accordingly
 * before the chip is initialized.
 */
int
bcm56160_a0_block_disable(int unit, uint32_t disable_tsc, uint32_t disable_qtc)
{
    int tidx, pidx;
    int start_port;
    cdk_pbmp_t pbmp;

    if (disable_tsc) {
        for (tidx = 0; tidx < TSC_MAX_BLK_COUNT; tidx++) {
            if ((disable_tsc >> tidx) & 0x1) {
                start_port = tsc_phy_port[tidx];

                for (pidx = 0; pidx < PORT_COUNT_PER_TSC; pidx++) {
                    _serdes_disabled[start_port + pidx] = 1;
                    BMD_PORT_PROPERTIES(unit, start_port + pidx) = 0;
                }
            }
        }
    }

    if (disable_qtc) {
        bcm56160_a0_qgphy_pbmp_get(unit, &pbmp);

        for (tidx = 0; tidx < QTC_MAX_BLK_COUNT; tidx++) {
            if ((disable_qtc >> tidx) & 0x1) {
                start_port = qtc_phy_port[tidx];

                for (pidx = 0; pidx < PORT_COUNT_PER_QTC; pidx++) {
                    if (CDK_PBMP_MEMBER(pbmp, start_port + pidx)) {
                        continue;
                    }
                    _serdes_disabled[start_port + pidx] = 1;
                    BMD_PORT_PROPERTIES(unit, start_port + pidx) = 0;
                }
            }
        }
    }

#if CDK_CONFIG_INCLUDE_PORT_MAP == 1
    _init_port_map(unit);
#endif /* CDK_CONFIG_INCLUDE_PORT_MAP */

    return 0;
}

int
bcm56160_a0_qgphy_pbmp_get(int unit, cdk_pbmp_t *pbmp)
{
    int tidx, pidx;
    int port;

    CDK_PBMP_CLEAR(*pbmp);

    for (tidx = 0; tidx < QGPHY_MAX_BLK_COUNT; tidx++) {
        for (pidx = 0; pidx < QGPHY_COUNT_PER_QTC; pidx++) {
            port = qgphy_port[tidx] + pidx;
            if (BMD_PORT_PROPERTIES(unit, port)) {
                CDK_PBMP_PORT_ADD(*pbmp, port);
            }
        }
    }

    return 0;
}

int
bcm56160_a0_gport_pbmp_get(int unit, cdk_pbmp_t *pbmp)
{
    int port;

    CDK_XGSD_BLKTYPE_PBMP_GET(unit, BLKTYPE_GPORT, pbmp);
    CDK_PBMP_ITER(*pbmp, port) {
        if (BMD_PORT_PROPERTIES(unit, port) == 0) {
            CDK_PBMP_PORT_REMOVE(*pbmp, port);
        }
    }
    return 0;
}

int
bcm56160_a0_xlport_pbmp_get(int unit, cdk_pbmp_t *pbmp)
{
    int port;

    CDK_XGSD_BLKTYPE_PBMP_GET(unit, BLKTYPE_XLPORT, pbmp);
    CDK_PBMP_ITER(*pbmp, port) {
        if (BMD_PORT_PROPERTIES(unit, port) == 0) {
            CDK_PBMP_PORT_REMOVE(*pbmp, port);
        }
    }
    return 0;
}

int
bcm56160_a0_block_index_get(int unit, int blk_type, int port)
{
    cdk_xgsd_pblk_t pblk;

    if (cdk_xgsd_port_block(unit, port, &pblk, blk_type)) {
        return -1 ;
    }
    return pblk.bindex;
}

int
bcm56160_a0_block_number_get(int unit, int blk_type, int port)
{
    cdk_xgsd_pblk_t pblk;

    if (cdk_xgsd_port_block(unit, port, &pblk, blk_type)) {
        return -1 ;
    }
    return pblk.block;
}

int
bcm56160_a0_block_subport_get(int unit, int blk_type, int port)
{
    cdk_xgsd_pblk_t pblk;

    if (cdk_xgsd_port_block(unit, port, &pblk, blk_type)) {
        return -1 ;
    }
    return pblk.bport;
}

int
bcm56160_a0_p2l(int unit, int port, int inverse)
{
    _cfg_map_t *pmap = &_port_cfgs[_pcfg_idx[unit]].p2l;
    int pp;

    /* Fixed mappings */
    if (port == CMIC_PORT) {
        return CMIC_LPORT;
    }

    /* Use per-port config if available */
    if (CDK_NUM_PORT_CONFIGS(unit) != 0) {
        if (inverse) {
            for (pp = 0; pp < NUM_PHYS_PORTS; pp++) {
                if (port == CDK_PORT_CONFIG_SYS_PORT(unit, pp)) {
                    return (_serdes_disabled[pp]) ? -1 : pp;
                }
            }
            return -1;
        } else {
            return (_serdes_disabled[port]) ? -1 :
                    CDK_PORT_CONFIG_SYS_PORT(unit, port);
        }
    }

    if (inverse) {
        for (pp = 0; pp < pmap->size; pp++) {
            if (port == pmap->val[pp]) {
                return (_serdes_disabled[pp]) ? -1 : pp;
            }
        }
        return -1;
    }
    if (port >= pmap->size) {
        return -1;
    }
    return (_serdes_disabled[port]) ? -1 : pmap->val[port];
}

int
bcm56160_a0_p2m(int unit, int port, int inverse)
{
    /* MMU port map is same as logical port map */
    return bcm56160_a0_p2l(unit, port, inverse);
}

uint32_t
bcm56160_a0_port_speed_max(int unit, int port)
{
    _cfg_map_t *pmap = &_port_cfgs[_pcfg_idx[unit]].speed_max;

    if (_serdes_disabled[port]) {
        return 0;
    }

    /* Use per-port config if available */
    if (CDK_NUM_PORT_CONFIGS(unit) != 0) {
        return CDK_PORT_CONFIG_SPEED_MAX(unit, port);
    }
    if (port < 0 || port >= pmap->size) {
        return 0;
    }
    if (pmap->val[port] < 0) {
        return 0;
    }

    return (100 * pmap->val[port]);
}

int
bcm56160_a0_tdm_default(int unit, const int **tdm_seq)
{
    _cfg_map_t *tdm = &_port_cfgs[_pcfg_idx[unit]].tdm;

    *tdm_seq = tdm->val;
    return tdm->size;
}

int
bcm56160_a0_qtcport_ratio(int unit, int port)
{
    cdk_pbmp_t pbmp;

    CDK_XGSD_BLKTYPE_PBMP_GET(unit, BLKTYPE_PMQ, &pbmp);
    if (CDK_PBMP_MEMBER(pbmp, port)) {
        if ((XPORT_SUBPORT(unit, BLKTYPE_PMQ, port) == 0) ||
            (XPORT_SUBPORT(unit, BLKTYPE_PMQ, port) == 8)) {
            if (P2L(unit, port + 7) != -1) {
                return BLOCK_PORT_RATIO_OCTAL;
            } else if (P2L(unit, port + 3) != -1) {
                return BLOCK_PORT_RATIO_QUAD;
            } else if (P2L(unit, port + 1) != -1) {
                return BLOCK_PORT_RATIO_DUAL_1_1;
            } else if (P2L(unit, port) != -1) {
                return BLOCK_PORT_RATIO_SINGLE;
            }
        }
    }

    return BLOCK_PORT_RATIO_NONE;
}

int
bcm56160_a0_xlport_ratio(int unit, int port)
{
    cdk_pbmp_t pbmp;

    CDK_XGSD_BLKTYPE_PBMP_GET(unit, BLKTYPE_XLPORT, &pbmp);
    if (CDK_PBMP_MEMBER(pbmp, port)) {
        if (XPORT_SUBPORT(unit, BLKTYPE_XLPORT, port) == 0) {
            if ((P2L(unit, port + 1) < 0) &&
                (P2L(unit, port + 2) < 0) &&
                (P2L(unit, port + 3) < 0)) {
                return BLOCK_PORT_RATIO_SINGLE;
            } else if ((P2L(unit, port + 1) < 0) &&
                       (P2L(unit, port + 3) < 0)) {
                if ((bcm56160_a0_port_speed_max(unit, port) > 11000) &&
                    (bcm56160_a0_port_speed_max(unit, port + 2) > 11000)) {
                    return BLOCK_PORT_RATIO_DUAL_2_2;
                } else if (bcm56160_a0_port_speed_max(unit, port + 2) > 11000) {
                    return BLOCK_PORT_RATIO_TRI_1_1_2;
                }
            } else if (P2L(unit, port + 3) < 0) {
                if (bcm56160_a0_port_speed_max(unit, port + 2) > 11000) {
                    return BLOCK_PORT_RATIO_TRI_1_1_2;
                }
            }

            return BLOCK_PORT_RATIO_QUAD;
        }
    }

    return BLOCK_PORT_RATIO_NONE;
}

int
bcm56160_a0_port_num_lanes(int unit, int port)
{
    cdk_pbmp_t gpbmp, xlpbmp;
    int lanes = 0, subport;
    int port_ratio;

    bcm56160_a0_gport_pbmp_get(unit, &gpbmp);
    if (CDK_PBMP_MEMBER(gpbmp, port)) {
        lanes = 1;
        if ((CDK_CHIP_CONFIG(unit) & DCFG_SGMII_MODE) ||
            (CDK_XGSD_FLAGS(unit) & CHIP_FLAG_SGMII_ONLY)) {
            lanes = 4;
        }
    }

    bcm56160_a0_xlport_pbmp_get(unit, &xlpbmp);
    if (CDK_PBMP_MEMBER(xlpbmp, port)) {
        subport = XLPORT_SUBPORT(unit, port);
        port_ratio = bcm56160_a0_xlport_ratio(unit, (port - subport));

        if (port_ratio == BLOCK_PORT_RATIO_SINGLE) {
            lanes = 4;
        } else if (port_ratio == BLOCK_PORT_RATIO_DUAL_2_2) {
            lanes = 2;
        } else if (port_ratio == BLOCK_PORT_RATIO_TRI_1_1_2) {
            if (subport == 2) {
                lanes = 2;
            } else {
                lanes = 1;
            }
        } else if (BLOCK_PORT_RATIO_QUAD) {
            lanes = 1;
        }
    }

    return lanes;
}

int
bcm56160_a0_bmd_attach(int unit)
{
    int port;
    cdk_pbmp_t pbmp, xlpbmp;
    uint32_t sgmii_override;
    uint32_t speed_max;
    uint32_t cfg;
    int cfg_id, list;
    int idx;

    if(!CDK_DEV_EXISTS(unit)) {
        return CDK_E_UNIT;
    }

    sgmii_override = (CDK_CHIP_CONFIG(unit) & DCFG_SGMII_MODE);

    /*
     * Get the list ID that is used to search port configurations
     * from _port_cfg_xlate[] table.
     */
    if (CDK_XGSD_FLAGS(unit) & CHIP_FLAG_QTC25G) {
        list = 5;
        if (CDK_XGSD_FLAGS(unit) & CHIP_FLAG_TSC40G) {
            list = 0;
        }
    } else {
        list = 4;
        if (CDK_XGSD_FLAGS(unit) & CHIP_FLAG_TSC13G) {
            list = 1;
        } else if (CDK_XGSD_FLAGS(unit) & CHIP_FLAG_SGMII_ONLY) {
            list = 2;
            /* Ignore the sgmii_override bit, if only SGMII mode support */
            sgmii_override = 0;
        } else if (CDK_XGSD_FLAGS(unit) & CHIP_FLAG_NO_TSC) {
            list = 6;
        } else if (CDK_XGSD_FLAGS(unit) & CHIP_FLAG_NO_TSC1) {
            list = 3;
        }
    }

    /* Select port configuration */
    cfg = CDK_CHIP_CONFIG(unit) & PORT_CONFIG_MASK;
    cfg_id = -1;
    for (idx = 0; idx < _port_cfg_xlate[list].count; idx++) {
        if (((uint32_t)_port_cfg_xlate[list].cfg_opt[idx]) == cfg) {
            cfg_id = _port_cfg_xlate[list].cfg_id[idx];
            break;
        }
    }
    if (cfg_id == -1) {
        CDK_WARN(("bcm56160_a0_bmd_attach[%d]: Invalid port config specified (%x). "
                  "Using default port config instead.\n",
                  unit, cfg));
        cfg_id = _port_cfg_xlate[list].cfg_id[0];
    }

    /* Plus 1000 is to distingish BYPASS mode */
    if (CDK_CHIP_CONFIG(unit) & DCFG_GPHY_BYPASS) {
        cfg_id = cfg_id + 1000;
    }
    
    _pcfg_idx[unit] = -1;
    for (idx = 0; idx < COUNTOF(_port_cfgs); idx++) {
        if (cfg_id == (int)_port_cfgs[idx].id) {
            _pcfg_idx[unit] = idx;
            break;
        }
    }

    /*
     * If SGMII mode has been selected, then we need to adjust port 
     * mappings and port capabilities accordingly.
     */
    if (sgmii_override) {
        _sgmii_mode_enable(unit);
    }

    CDK_XGSD_BLKTYPE_PBMP_GET(unit, BLKTYPE_GPORT, &pbmp);
    CDK_XGSD_BLKTYPE_PBMP_GET(unit, BLKTYPE_XLPORT, &xlpbmp);
    CDK_PBMP_OR(pbmp, xlpbmp);
    CDK_PBMP_ITER(pbmp, port) {
        CDK_ASSERT(port < BMD_CONFIG_MAX_PORTS);
        BMD_PORT_PROPERTIES(unit, port) = 0;

        speed_max = bcm56160_a0_port_speed_max(unit, port);
        if (speed_max <= 0) {
            continue;
        }
        if (speed_max > 2500) {
#if BMD_CONFIG_INCLUDE_HIGIG == 1
            if (speed_max == 11000 || speed_max == 13000 ||
                speed_max == 21000 || speed_max == 42000) {
                BMD_PORT_PROPERTIES(unit, port) |= BMD_PORT_HG;
            } else
#endif /* BMD_CONFIG_INCLUDE_HIGIG == 1 */
            BMD_PORT_PROPERTIES(unit, port) |= BMD_PORT_XE;
        } else {
            BMD_PORT_PROPERTIES(unit, port) |= BMD_PORT_GE;
        }

#if BMD_CONFIG_INCLUDE_PHY == 1
        if ((CDK_CHIP_CONFIG(unit) & DCFG_SGMII_MODE) ||
            (CDK_XGSD_FLAGS(unit) & CHIP_FLAG_SGMII_ONLY)) {
            bmd_phy_bus_set(unit, port, bcm56160_sgmii_phy_bus);
        } else {
            /* Configure GPHY bypass mode */
            if (CDK_CHIP_CONFIG(unit) & DCFG_GPHY_BYPASS) {
                bmd_phy_bus_set(unit, port, bcm56160_bypass_phy_bus);
            } else {
                bmd_phy_bus_set(unit, port, bcm56160_phy_bus);
            }
        }
        

#endif /* BMD_CONFIG_INCLUDE_PHY */
    }

    port = CMIC_PORT;
    CDK_ASSERT(port < BMD_CONFIG_MAX_PORTS);
    BMD_PORT_PROPERTIES(unit, port) = BMD_PORT_CPU;

#if CDK_CONFIG_INCLUDE_PORT_MAP == 1
    _init_port_map(unit);
#endif /* CDK_CONFIG_INCLUDE_PORT_MAP */

    /* Initialize debug functions */
    BMD_PORT_SPEED_MAX(unit) = bcm56160_a0_port_speed_max;
    BMD_PORT_P2L(unit) = bcm56160_a0_p2l;
    BMD_PORT_P2M(unit) = bcm56160_a0_p2m;

    BMD_DEV_FLAGS(unit) |= BMD_DEV_ATTACHED;

    return 0;
}

#endif /* CDK_CONFIG_INCLUDE_BCM56160_A0 */
