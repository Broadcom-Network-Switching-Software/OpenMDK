#include <bmd_config.h>
#if CDK_CONFIG_INCLUDE_BCM56340_A0 == 1

/*
 * 
 * This software is governed by the Broadcom Switch APIs license.
 * This license is set out in https://raw.githubusercontent.com/Broadcom-Network-Switching-Software/OpenMDK/master/Legal/LICENSE file.
 * 
 * Copyright 2007-2020 Broadcom Inc. All rights reserved.
 */

#include <bmd/bmd.h>
#include <bmd/bmd_device.h>
#include <bmd/bmd_phy_ctrl.h>

#include <cdk/chip/bcm56340_a0_defs.h>
#include <cdk/arch/xgsm_chip.h>
#include <cdk/cdk_debug.h>
#include <cdk/cdk_assert.h>

#include "bcm56340_a0_bmd.h"
#include "bcm56340_a0_internal.h"

#if BMD_CONFIG_INCLUDE_PHY == 1

#include <phy/phy_buslist.h>

static phy_bus_t *bcm56340_phy_bus[] = {
#ifdef PHY_BUS_BCM56340_MIIM_INT_INSTALLED
    &phy_bus_bcm56340_miim_int,
#endif
#ifdef PHY_BUS_BCM956340K_MIIM_EXT_INSTALLED
    &phy_bus_bcm956340k_miim_ext,
#endif
    NULL
};

#define PHY_BUS_SET(_u,_p,_b) bmd_phy_bus_set(_u,_p,_b)

#else

#define PHY_BUS_SET(_u,_p,_b)

#endif

/* 12x2.5G (SGMII) + 12x2.5G + 1GE */
static const int p2l_mapping_11[] = {
     0,
     1, -1, -1, -1,  2, -1, -1, -1,  3, -1, -1, -1,
     4, -1, -1, -1,  5, -1, -1, -1,  6, -1, -1, -1,
     7, -1, -1, -1,  8, -1, -1, -1,  9, -1, -1, -1,
    10, -1, -1, -1, 11, -1, -1, -1, 12, -1, -1, -1,
    13, -1, -1, -1,
    14, 15, 16, 17,
    18, 19, 20, 21,
    22, 23, 24, 25,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_11[] = {
    59,
     0, -1, -1, -1,  1, -1, -1, -1,  2, -1, -1, -1,
     3, -1, -1, -1,  4, -1, -1, -1,  5, -1, -1, -1,
     6, -1, -1, -1,  7, -1, -1, -1,  8, -1, -1, -1,
     9, -1, -1, -1, 10, -1, -1, -1, 11, -1, -1, -1,
    60, -1, -1, -1,
    12, 13, 14, 15,
    16, 17, 18, 19,
    20, 21, 22, 23,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_11[] = {
    -1,
     3, -1, -1, -1,  3, -1, -1, -1,  3, -1, -1, -1,
     3, -1, -1, -1,  3, -1, -1, -1,  3, -1, -1, -1,
     3, -1, -1, -1,  3, -1, -1, -1,  3, -1, -1, -1,
     3, -1, -1, -1,  3, -1, -1, -1,  3, -1, -1, -1,
     1, -1, -1, -1,
     3,  3,  3,  3,
     3,  3,  3,  3,
     3,  3,  3,  3,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1
};
/* 12xF.QSGMII + 4xSGMII + 2xXFI + 2xHGd[21] + 1GE */
static const int p2l_mapping_400[] = {
     0,
     1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12,
    13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
    25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36,
    37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,
    49, -1, -1, -1,
    50, 51, 52, 53,
    54, 55, -1, -1,
    56, -1, 57, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_400[] = {
    59,
     0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,
    12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
    24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
    36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,
    60, -1, -1, -1,
    48, 49, 50, 51,
    52, 53, -1, -1,
    54, -1, 55, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_400[] = {
    -1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1, -1, -1, -1,
     3,  3,  3,  3,
    10, 10, -1, -1,
    21, -1, 21, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1
};
/* 12xF.QSGMII + Flex[4x10] + 2xHG[21] + 1GE */
static const int p2l_mapping_410[] = {
     0,
     1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12,
    13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
    25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36,
    37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,
    49, -1, -1, -1,
    50, 51, 52, 53,
    54, -1, -1, -1,
    55, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_410[] = {
    59,
     0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,
    12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
    24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
    36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,
    60, -1, -1, -1,
    48, 49, 50, 51,
    52, -1, -1, -1,
    53, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_410[] = {
    -1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1, -1, -1, -1,
    21, -1, -1, -1,
    21, -1, -1, -1,
    21, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1
};
/* 1xF.QSGMII + 3xFlex[4x10] + 1GE */
static const int p2l_mapping_420[] = {
     0,
     1,  2,  3,  4, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
     5, -1, -1, -1,
     9, -1, -1, -1,
    13, -1, -1, -1,
    17, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_420[] = {
    59,
     1,  2,  3,  4, -1, -1, -1, -1, -1, -1, -1, -1, 
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    60, -1, -1, -1,
    44, 45, 46, 47,
    48, 49, 50, 51,
    52, 53, 54, 55,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_420[] = {
    -1,
     1,  1,  1,  1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
     1, -1, -1, -1,
    21, -1, -1, -1,
    21, -1, -1, -1,
    21, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1
};
/* 1xF.QSGMII + 3xF.HG[42] + 1GE */
static const int p2l_mapping_450[] = {
     0,
     1,  2,  3,  4, -1, -1, -1, -1, -1, -1, -1, -1, 
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
     5, -1, -1, -1,
     9, 10, 11, 12,
    13, 14, 15, 16,
    17, 18, 19, 20,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_450[] = {
    59,
     1,  2,  3,  4, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    60, -1, -1, -1,
    44, 45, 46, 47,
    48, 49, 50, 51,
    52, 53, 54, 55,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_450[] = {
    -1,
     1,  1,  1,  1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
     1, -1, -1, -1,
    42, -1, -1, -1,
    42, -1, -1, -1,
    42, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1
};
/* 7xF.QSGMII + Flex[4x10] + 2xHG[21] + 1GE */
static const int p2l_mapping_460[] = {
     0,
     1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12,
    13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
    25, 26, 27, 28, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    49, -1, -1, -1,
    50, 51, 52, 53,
    54, -1, -1, -1,
    55, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_460[] = {
    59,
     0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,
    12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
    24, 25, 26, 27, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    60, -1, -1, -1,
    48, 49, 50, 51,
    52, -1, -1, -1,
    53, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_460[] = {
    -1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
     1, -1, -1, -1,
    21, -1, -1, -1,
    21, -1, -1, -1,
    21, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1
};
/* 10xF.QSGMII + 3xF.HG[42] + 1GE  */
static const int p2l_mapping_490[] = {
     0,
     1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12,
    13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
    25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36,
    37, 38, 39, 40, -1, -1, -1, -1, -1, -1, -1, -1,
    41, -1, -1, -1,
    42, -1, -1, -1,
    46, -1, -1, -1,
    50, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_490[] = {
    59,
     0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,
    12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
    24, 25, 26, 27, 28, 29, 30, 31, 36, 37, 38, 39,
    41, 42, 43, 44, -1, -1, -1, -1, -1, -1, -1, -1,
    60, -1, -1, -1,
    48, 32, 49, 33,
    50, 34, 51, 35,
    52, 53, 54, 55,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_490[] = {
    -1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1, -1, -1, -1, -1, -1, -1, -1, -1,
     1, -1, -1, -1,
    42, -1, -1, -1,
    42, -1, -1, -1,
    42, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1
};
/* 7xF.QSGMII + 3xF.HG[42] + 1GE  */
static const int p2l_mapping_491[] = {
     0,
     1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12,
    13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
    25, 26, 27, 28, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    41, -1, -1, -1,
    42, -1, -1, -1,
    46, -1, -1, -1,
    50, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_491[] = {
    59,
     0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,
    12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
    24, 25, 26, 27, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    60, -1, -1, -1,
    48, 32, 49, 33,
    50, 34, 51, 35,
    52, 53, 54, 55,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_491[] = {
    -1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
     1, -1, -1, -1,
    42, -1, -1, -1,
    42, -1, -1, -1,
    42, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1
};
/* 12xF.QSGMII + F.HG[42] + 2xHG[42] + 1GE  */
static const int p2l_mapping_495[] = {
     0,
     1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12,
    13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
    25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36,
    37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,
    49, -1, -1, -1,
    50, 51, 52, 53,
    54, -1, -1, -1,
    55, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_495[] = {
    59,
     0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,
    12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
    24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
    36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,
    60, -1, -1, -1,
    48, 49, 50, 51,
    52, -1, -1, -1,
    53, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_495[] = {
    -1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1, -1, -1, -1,
    42, -1, -1, -1,
    42, -1, -1, -1,
    42, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1
};
/* 10xF.QSGMII + 3xFlex[4x10] + 1GE */
static const int p2l_mapping_497[] = {
     0,
     1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12,
    13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
    25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36,
    37, 38, 39, 40, -1, -1, -1, -1, -1, -1, -1, -1,
    41, -1, -1, -1,
    42, 43, 44, 45,
    46, 47, 48, 49,
    50, 51, 52, 53,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_497[] = {
    59,
     0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,
    12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
    24, 25, 26, 27, 28, 29, 30, 31, 36, 37, 38, 39,
    41, 42, 43, 44, -1, -1, -1, -1, -1, -1, -1, -1,
    60, -1, -1, -1,
    48, 32, 49, 33,
    50, 34, 51, 35,
    52, 53, 54, 55,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_497[] = {
    -1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1, -1, -1, -1, -1, -1, -1, -1, -1,
     1, -1, -1, -1,
    10, 10, 10, 10,
    10, 10, 10, 10,
    10, 10, 10, 10,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1
};
/* 12xF.QSGMII + 2xF.HG[42] + 1GE */
static const int p2l_mapping_500[] = {
     0,
     1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12,
    13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
    25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36,
    37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,
    49, -1, -1, -1,
    50, 51, 52, 53,
    54, 55, 56, 57,
    -1, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_500[] = {
    59,
     0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,
    12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
    24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
    36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,
    60, -1, -1, -1,
    48, 49, 50, 51,
    52, 53, 54, 55,
    -1, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_500[] = {
    -1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1, -1, -1, -1,
    42, -1, -1, -1,
    42, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    11, -1, -1, -1, -1
};
/* 12xF.QSGMII + 2xFlex[4x10] + 1GE */
static const int p2l_mapping_510[] = {
     0,
     1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12,
    13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
    25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36,
    37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,
    49, -1, -1, -1,
    50, -1, -1, -1,
    54, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_510[] = {
    59,
     0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,
    12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
    24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
    36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,
    60, -1, -1, -1,
    48, 49, 50, 51,
    52, 53, 54, 55,
    -1, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_510[] = {
    -1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1, -1, -1, -1,
    21, -1, -1, -1,
    21, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1
};
/* 7xF.QSGMII + 2xFlex[4x10] + 1GE */
static const int p2l_mapping_514[] = {
     0,
     1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12,
    13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
    25, 26, 27, 28, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    49, -1, -1, -1,
    50, -1, -1, -1,
    54, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_514[] = {
    59,
     0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,
    12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
    24, 25, 26, 27, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    60, -1, -1, -1,
    48, 49, 50, 51,
    52, 53, 54, 55,
    -1, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_514[] = {
    -1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
     1, -1, -1, -1,
    21, -1, -1, -1,
    21, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1
};
/* 12xF.QSGMII + 2xFlex[4x10] + 1GE */
static const int p2l_mapping_610[] = {
     0,
     1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12,
    13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,
    25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36,
    37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,
    49, -1, -1, -1,
    50, -1, -1, -1,
    54, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    61, 59, 58, 60, 62
};
static const int p2m_mapping_610[] = {
    59,
     0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11,
    12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
    24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
    36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47,
    60, -1, -1, -1,
    48, 49, 50, 51,
    52, 53, 54, 55,
    -1, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    58, 62, 56, 61, 57
};
static const int port_speed_max_610[] = {
    -1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
     1, -1, -1, -1,
    21, -1, -1, -1,
    21, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1,
    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
    -1, -1, -1, -1, -1
};

static int tdm_seq_11[] = { /* RGR_2P5G_150 */
    53, 57,  1, 13, -1, 61, 25, 54, 58, 37,  5, 81, 62, 17, 29, 
    55, 59, 41, -1, 63, -1, -1, 56, 60, -1, -1, 64, 81,  0,
    53, 57,  9, 21, -1, 61, 33, 54, 58, 45,  1, 81, 62, 13, 25, 
    55, 59, 37, -1, 63, -1, -1, 56, 60, -1, -1, 64, 81,  0,
    53, 57,  5, 17, -1, 61, 29, 54, 58, 41,  9, 81, 62, 21, 33, 
    55, 59, 45, -1, 63, -1, -1, 56, 60, -1, -1, 64, 81, -1,
    53, 57,  1, 13, -1, 61, 25, 54, 58, 37,  5, 81, 62, 17, 29, 
    55, 59, 41, -1, 63, -1, -1, 56, 60, -1, -1, 64, 81,  0,
    53, 57,  9, 21, -1, 61, 33, 54, 58, 45, 49, 81, 62, 17, -1, 
    55, 59, -1, -1, 63, -1, -1, 56, 60, -1, -1, 64, 81,  0
};
static int tdm_seq_400[] = { /* HX4_1G_150_A */
    61, 57,  1, 13, 63, 53, 25, 61, 58, 37,  5, 63, 54, 17, 29,
    61, 57, 41, 63, 55,  9, 81, 61, 58, 33, 63, 56, 81,  0,
    61, 57,  2, 21, 63, 53, 26, 61, 58, 45,  6, 63, 54, 14, 30,
    61, 57, 38, 63, 55, 18, 81, 61, 58, 42, 63, 56, 81,  0,
    61, 57, 10, 22, 63, 53, 34, 61, 58, 46,  3, 63, 54, 15, 27,
    61, 57, 39, 63, 55,  7, 81, 61, 58, 31, 63, 56, 81, -1,
    61, 57, 11, 19, 63, 53, 35, 61, 58, 43,  4, 63, 54, 23, 28,
    61, 57, 47, 63, 55, 16, 81, 61, 58, 40, 63, 56, 81,  0,
    61, 57,  8, 20, 63, 53, 32, 61, 58, 44, 12, 63, 54, 24, 36,
    61, 57, 48, 63, 55, 49, 81, 61, 58, -1, 63, 56, 81,  0
};
static int tdm_seq_410[] = { /* HX4_1G_150_B, HX4_1G_150_C */
    53, 57,  1, 13, 53, 61, 25, 53, 57, 37,  5, 53, 61, 17, 29,
    53, 57, 41, 53, 61,  9, 81, 53, 57, 33, 53, 61, 81,  0,
    53, 57,  2, 21, 53, 61, 26, 53, 57, 45,  6, 53, 61, 14, 30,
    53, 57, 38, 53, 61, 18, 81, 53, 57, 42, 53, 61, 81,  0,
    53, 57, 10, 22, 53, 61, 34, 53, 57, 46,  3, 53, 61, 15, 27,
    53, 57, 39, 53, 61,  7, 81, 53, 57, 31, 53, 61, 81, -1,
    53, 57, 11, 19, 53, 61, 35, 53, 57, 43,  4, 53, 61, 23, 28,
    53, 57, 47, 53, 61, 16, 81, 53, 57, 40, 53, 61, 81,  0,
    53, 57,  8, 20, 53, 61, 32, 53, 57, 44, 12, 53, 61, 24, 36,
    53, 57, 48, 53, 61, 49, 81, 53, 57, -1, 53, 61, 81,  0
};
static int tdm_seq_420[] = { /* RGR_XFI_150 */
    53, 57, 61, 81, 53, 57, 61, 53, 57, 61,  1, 53, 57, 61, 81, 
    53, 57, 61, 53, 57, 61, 0, 53, 57, 61, 53, 57, 61, -1,
    53, 57, 61, 81, 53, 57, 61, 53, 57, 61,  2, 53, 57, 61, 81, 
    53, 57, 61, 53, 57, 61, 0, 53, 57, 61, 53, 57, 61, -1,
    53, 57, 61, 81, 53, 57, 61, 53, 57, 61,  3, 53, 57, 61, 81, 
    53, 57, 61, 53, 57, 61, 0, 53, 57, 61, 53, 57, 61, -1,
    53, 57, 61, 81, 53, 57, 61, 53, 57, 61,  4, 53, 57, 61, 81, 
    53, 57, 61, 53, 57, 61, 0, 53, 57, 61, 53, 57, 61, -1,
    53, 57, 61, 81, 53, 57, 61, 53, 57, 61, 49, 53, 57, 61, 81, 
    53, 57, 61, 53, 57, 61, 0, 53, 57, 61, 53, 57, 61, -1
};
static int tdm_seq_450[] = { /* RGR_XFI_200 */
    53, 57, 61, 81,  0, 53, 57, 61, -1, 53, 57, 61, 81, -1,
    53, 57, 61, -1,  1, 53, 57, 61, 81,  0, 53, 57, 61, -1,
    53, 57, 61, 81, -1, 53, 57, 61, -1,
    53, 57, 61, 81,  0, 53, 57, 61, -1, 53, 57, 61, 81, -1,
    53, 57, 61, -1,  2, 53, 57, 61, 81,  0, 53, 57, 61, -1,
    53, 57, 61, 81, -1, 53, 57, 61, -1,
    53, 57, 61, 81,  0, 53, 57, 61, -1, 53, 57, 61, 81, -1,
    53, 57, 61, -1,  3, 53, 57, 61, 81,  0, 53, 57, 61, -1,
    53, 57, 61, 81, -1, 53, 57, 61, -1,
    53, 57, 61, 81,  0, 53, 57, 61, -1, 53, 57, 61, 81, -1,
    53, 57, 61, -1,  4, 53, 57, 61, 81,  0, 53, 57, 61, -1,
    53, 57, 61, 81, -1, 53, 57, 61, -1,
    53, 57, 61, 81,  0, 53, 57, 61, -1, 53, 57, 61, 81, -1,
    53, 57, 61, -1, 49, 53, 57, 61, 81,  0, 53, 57, 61, -1,
    53, 57, 61, 81, -1, 53, 57, 61, -1
};
static int tdm_seq_460[] = { /* HX4_1G_130 */
    53, 57,  1, 13, 53, 61, 25, 53, 57,  5, 53, 61, 17,
    53, 57, 81, 53, 61,  9, 53, 57, -1, 53, 61,  0,
    53, 57,  2, 21, 53, 61, 26, 53, 57,  6, 53, 61, 14,
    53, 57, 81, 53, 61, 18, 53, 57, 81, 53, 61,  0,
    53, 57, 10, 22, 53, 61, 27, 53, 57,  3, 53, 61, 15,
    53, 57, 81, 53, 61,  7, 53, 57, 81, 53, 61, -1,
    53, 57, 11, 19, 53, 61, 28, 53, 57,  4, 53, 61, 23,
    53, 57, 81, 53, 61, 16, 53, 57, 81, 53, 61,  0,
    53, 57,  8, 20, 53, 61, -1, 53, 57, 12, 53, 61, 24,
    53, 57, 81, 53, 61, 49, 53, 57, 81, 53, 61,  0
};
static int tdm_seq_490[] = { /* HX4_1G_200_D */
    53, 57, 61,  1, 13, 53, 57, 61, 25, -1, 53, 57, 61,  5, 17, 53, 57, 61, 29, 
    37, 53, 57, 61, 81, 53, 57, 61,  9, 53, 57, 61, 33,  0, 53, 57, 61, 81,
    53, 57, 61,  2, 21, 53, 57, 61, 26, -1, 53, 57, 61,  6, 14, 53, 57, 61, 30, 
    38, 53, 57, 61, 81, 53, 57, 61, 18, 53, 57, 61, -1,  0, 53, 57, 61, 81,
    53, 57, 61, 10, 22, 53, 57, 61, 34, -1, 53, 57, 61,  3, 15, 53, 57, 61, 27, 
    39, 53, 57, 61, 81, 53, 57, 61,  7, 53, 57, 61, 31, -1, 53, 57, 61, 81,
    53, 57, 61, 11, 19, 53, 57, 61, 35, -1, 53, 57, 61,  4, 23, 53, 57, 61, 28, 
    40, 53, 57, 61, 81, 53, 57, 61, 16, 53, 57, 61, -1,  0, 53, 57, 61, 81,
    53, 57, 61,  8, 20, 53, 57, 61, 32, -1, 53, 57, 61, 12, 24, 53, 57, 61, 36, 
    -1, 53, 57, 61, 81, 53, 57, 61, 49, 53, 57, 61, -1,  0, 53, 57, 61, 81
};
static int tdm_seq_491[] = { /* HX4_1G_200_D* */
    53, 57, 61,  1, 13, 53, 57, 61, 25, -1, 53, 57, 61,  5, 17, 53, 57, 61, -1, 
    -1, 53, 57, 61, 81, 53, 57, 61,  9, 53, 57, 61, -1,  0, 53, 57, 61, 81,
    53, 57, 61,  2, 21, 53, 57, 61, 26, -1, 53, 57, 61,  6, 14, 53, 57, 61, -1, 
    -1, 53, 57, 61, 81, 53, 57, 61, 18, 53, 57, 61, -1,  0, 53, 57, 61, 81,
    53, 57, 61, 10, 22, 53, 57, 61, -1, -1, 53, 57, 61,  3, 15, 53, 57, 61, 27, 
    -1, 53, 57, 61, 81, 53, 57, 61,  7, 53, 57, 61, -1, -1, 53, 57, 61, 81,
    53, 57, 61, 11, 19, 53, 57, 61, -1, -1, 53, 57, 61,  4, 23, 53, 57, 61, 28, 
    -1, 53, 57, 61, 81, 53, 57, 61, 16, 53, 57, 61, -1,  0, 53, 57, 61, 81,
    53, 57, 61,  8, 20, 53, 57, 61, -1, -1, 53, 57, 61, 12, 24, 53, 57, 61, -1, 
    -1, 53, 57, 61, 81, 53, 57, 61, 49, 53, 57, 61, -1,  0, 53, 57, 61, 81
};
static int tdm_seq_495[] = { /* HX4_1G_200_A */
    53, 57, 61,  1, 13, 53, 57, 61, 25, 37, 53, 57, 61,  5, 17,
    53, 57, 61, 29, 41, 53, 57, 61, 81, 53, 57, 61,  9,
    53, 57, 61, 33,  0, 53, 57, 61, 81, 53, 57, 61,  2, 21,
    53, 57, 61, 26, 45, 53, 57, 61,  6, 14, 53, 57, 61, 30, 38,
    53, 57, 61, 81, 53, 57, 61, 18, 53, 57, 61, 42,  0,
    53, 57, 61, 81, 53, 57, 61, 10, 22, 53, 57, 61, 34, 46,
    53, 57, 61,  3, 15, 53, 57, 61, 27, 39, 53, 57, 61, 81, 53,
    57, 61,  7, 53, 57, 61, 31, -1, 53, 57, 61, 81,
    53, 57, 61, 11, 19, 53, 57, 61, 35, 43, 53, 57, 61,  4, 23,
    53, 57, 61, 28, 47, 53, 57, 61, 81, 53, 57, 61, 16,
    53, 57, 61, 40,  0, 53, 57, 61, 81, 53, 57, 61,  8, 20,
    53, 57, 61, 32, 44, 53, 57, 61, 12, 24, 53, 57, 61, 36, 48,
    53, 57, 61, 81, 53, 57, 61, 49, 53, 57, 61, -1,  0,
    53, 57, 61, 81
};
static int tdm_seq_497[] = { /* HX4_1G_200_D */
    53, 57, 61,  1, 13, 54, 58, 62, 25, -1, 55, 59, 63,  5, 17, 56, 60, 64, 29, 
    37, 53, 57, 61, 81, 54, 58, 62,  9, 55, 59, 63, 33,  0, 56, 60, 64, 81,
    53, 57, 61,  2, 21, 54, 58, 62, 26, -1, 55, 59, 63,  6, 14, 56, 60, 64, 30, 
    38, 53, 57, 61, 81, 54, 58, 62, 18, 55, 59, 63, -1,  0, 56, 60, 64, 81,
    53, 57, 61, 10, 22, 54, 58, 62, 34, -1, 55, 59, 63,  3, 15, 56, 60, 64, 27, 
    39, 53, 57, 61, 81, 54, 58, 62,  7, 55, 59, 63, 31, -1, 56, 60, 64, 81,
    53, 57, 61, 11, 19, 54, 58, 62, 35, -1, 55, 59, 63,  4, 23, 56, 60, 64, 28, 
    40, 53, 57, 61, 81, 54, 58, 62, 16, 55, 59, 63, -1,  0, 56, 60, 64, 81,
    53, 57, 61,  8, 20, 54, 58, 62, 32, -1, 55, 59, 63, 12, 24, 56, 60, 64, 36, 
    -1, 53, 57, 61, 81, 54, 58, 62, 49, 55, 59, 63, -1,  0, 56, 60, 64, 81
};
static int tdm_seq_500[] = { /* HX4_1G_200_E */
    53, 57, -1,  1, 13, 53, 57, -1, 25, 37, 53, 57, -1,  5, 17,
    53, 57, -1, 29, 41, 53, 57, -1, 81, 53, 57, -1,  9,
    53, 57, -1, 33,  0, 53, 57, -1, 81, 53, 57, -1,  2, 21,
    53, 57, -1, 26, 45, 53, 57, -1,  6, 14, 53, 57, -1, 30, 38,
    53, 57, -1, 81, 53, 57, -1, 18, 53, 57, -1, 42,  0,
    53, 57, -1, 81, 53, 57, -1, 10, 22, 53, 57, -1, 34, 46,
    53, 57, -1,  3, 15, 53, 57, -1, 27, 39, 53, 57, -1, 81,
    53, 57, -1,  7, 53, 57, -1, 31, -1, 53, 57, -1, 81,
    53, 57, -1, 11, 19, 53, 57, -1, 35, 43, 53, 57, -1,  4, 23,
    53, 57, -1, 28, 47, 53, 57, -1, 81, 53, 57, -1, 16,
    53, 57, -1, 40,  0, 53, 57, -1, 81, 53, 57, -1,  8, 20,
    53, 57, -1, 32, 44, 53, 57, -1, 12, 24, 53, 57, -1, 36, 48,
    53, 57, -1, 81, 53, 57, -1, 49, 53, 57, -1, -1,  0,
    53, 57, -1, 81
};
static int tdm_seq_510[] = { /* HX4_1G_200_E*: 12xF.QSGMII + 2xFlex[4x10] + 1GE */
    53, 57, -1,  1, 13, 53, 57, -1, 25, 37, 53, 57, -1,  5, 17, 53, 57, -1, 29, 
    41, 53, 57, -1, 81, 53, 57, -1,  9, 53, 57, -1, 33,  0, 53, 57, -1, 81,
    53, 57, -1,  2, 21, 53, 57, -1, 26, 45, 53, 57, -1,  6, 14, 53, 57, -1, 30, 
    38, 53, 57, -1, 81, 53, 57, -1, 18, 53, 57, -1, 42,  0, 53, 57, -1, 81,
    53, 57, -1, 10, 22, 53, 57, -1, 34, 46, 53, 57, -1,  3, 15, 53, 57, -1, 27, 
    39, 53, 57, -1, 81, 53, 57, -1,  7, 53, 57, -1, 31, -1, 53, 57, -1, 81,
    53, 57, -1, 11, 19, 53, 57, -1, 35, 43, 53, 57, -1,  4, 23, 53, 57, -1, 28, 
    47, 53, 57, -1, 81, 53, 57, -1, 16, 53, 57, -1, 40,  0, 53, 57, -1, 81,
    53, 57, -1,  8, 20, 53, 57, -1, 32, 44, 53, 57, -1, 12, 24, 53, 57, -1, 36, 
    48, 53, 57, -1, 81, 53, 57, -1, 49, 53, 57, -1, -1,  0, 53, 57, -1, 81
};
static int tdm_seq_514[] = { /* HX4_1G_200_E*: 7xF.QSGMII + 2xFlex[4x10] + 1GE */
    53, 57, -1,  1, 13, 53, 57, -1, 25, -1, 53, 57, -1,  5, 17, 53, 57, -1, -1, 
    -1, 53, 57, -1, 81, 53, 57, -1,  9, 53, 57, -1, -1,  0, 53, 57, -1, 81,
    53, 57, -1,  2, 21, 53, 57, -1, 26, -1, 53, 57, -1,  6, 14, 53, 57, -1, -1, 
    -1, 53, 57, -1, 81, 53, 57, -1, 18, 53, 57, -1, -1,  0, 53, 57, -1, 81,
    53, 57, -1, 10, 22, 53, 57, -1, -1, -1, 53, 57, -1,  3, 15, 53, 57, -1, 27, 
    -1, 53, 57, -1, 81, 53, 57, -1,  7, 53, 57, -1, -1, -1, 53, 57, -1, 81,
    53, 57, -1, 11, 19, 53, 57, -1, -1, -1, 53, 57, -1,  4, 23, 53, 57, -1, 28, 
    -1, 53, 57, -1, 81, 53, 57, -1, 16, 53, 57, -1, -1,  0, 53, 57, -1, 81,
    53, 57, -1,  8, 20, 53, 57, -1, -1, -1, 53, 57, -1, 12, 24, 53, 57, -1, -1, 
    -1, 53, 57, -1, 81, 53, 57, -1, 49, 53, 57, -1, -1,  0, 53, 57, -1, 81
};
static int tdm_seq_610[] = { /* HX4_1G_200_E*: 12xF.QSGMII + 2xFlex[4x10] + 1GE */
    53, 57,  1, 13, 53, 57, 25, 53, 57, 37,  5, 53, 57, 17, 29,
    53, 57, 41, 53, 57,  9, 81, 53, 57, 33, 53, 57, 81,  0,
    53, 57,  2, 21, 53, 57, 26, 53, 57, 45,  6, 53, 57, 14, 30,
    53, 57, 38, 53, 57, 18, 81, 53, 57, 42, 53, 57, 81,  0,
    53, 57, 10, 22, 53, 57, 34, 53, 57, 46,  3, 53, 57, 15, 27,
    53, 57, 39, 53, 57,  7, 81, 53, 57, 31, 53, 57, 81, -1,
    53, 57, 11, 19, 53, 57, 35, 53, 57, 43,  4, 53, 57, 23, 28,
    53, 57, 47, 53, 57, 16, 81, 53, 57, 40, 53, 57, 81,  0,
    53, 57,  8, 20, 53, 57, 32, 53, 57, 44, 12, 53, 57, 24, 36,
    53, 57, 48, 53, 57, 49, 81, 53, 57, -1, 53, 57, 81,  0
};

typedef struct _cfg_map_s {
    int size;
    const int *val;
} _cfg_map_t;

typedef struct _port_cfg_s {
    int id;
    _cfg_map_t p2l;
    _cfg_map_t p2m;
    _cfg_map_t speed_max;
    _cfg_map_t tdm;
} _port_cfg_t;

#define _CFG_MAP(_cfg) { COUNTOF(_cfg), _cfg }

#define _PORT_CFG(_id) { \
    _id, \
    _CFG_MAP(p2l_mapping_##_id), \
    _CFG_MAP(p2m_mapping_##_id), \
    _CFG_MAP(port_speed_max_##_id), \
    _CFG_MAP(tdm_seq_##_id) \
}

static _port_cfg_t _port_cfgs[] = {
    _PORT_CFG(11),
    _PORT_CFG(400),
    _PORT_CFG(410),
    _PORT_CFG(420),
    _PORT_CFG(450),
    _PORT_CFG(460),
    _PORT_CFG(490),
    _PORT_CFG(491),
    _PORT_CFG(495),
    _PORT_CFG(497),
    _PORT_CFG(500),
    _PORT_CFG(510),
    _PORT_CFG(514),
    _PORT_CFG(610)
};

/* Port configuration index for this unit */
static int _cfg_idx[BMD_CONFIG_MAX_UNITS];

/* Unicast queue base per unit/port */
static int _uc_q_base[BMD_CONFIG_MAX_UNITS][BMD_CONFIG_MAX_PORTS];

#if CDK_CONFIG_INCLUDE_PORT_MAP == 1

static struct _port_map_s {
    cdk_port_map_port_t map[BMD_CONFIG_MAX_PORTS];
} _port_map[BMD_CONFIG_MAX_UNITS];

static void
_init_port_map(int unit)
{
    cdk_pbmp_t pbmp;
    int lport, lport_max = 0;
    int port;

    CDK_MEMSET(&_port_map[unit], -1, sizeof(_port_map[unit]));

    _port_map[unit].map[0] = CMIC_PORT;

    bcm56340_a0_xport_pbmp_get(unit, XPORT_FLAG_ALL, &pbmp);
    CDK_PBMP_ITER(pbmp, port) {
        lport = P2L(unit, port);
        _port_map[unit].map[lport] = port;
        if (lport > lport_max) {
            lport_max = lport;
        }
    }

    CDK_PORT_MAP_SET(unit, _port_map[unit].map, lport_max + 1);
}

#endif

static uint32_t
_default_port_speed_max(int unit, int port)
{
    _cfg_map_t *pmap = &_port_cfgs[_cfg_idx[unit]].speed_max;

    if (port >= pmap->size) {
        return -1;
    }
    if (pmap->val[port] < 0) {
        return 0;
    }
    if (pmap->val[port] == 3) {
        return 2500;
    }
    
    return (1000 * pmap->val[port]);
}

static int
_is_flex_port(int unit, int port)
{
    uint32_t speed;

    speed = _default_port_speed_max(unit, port);
    if (speed == 0 && P2L(unit, port) >= 0) {
        return 1;
    }

    speed = _default_port_speed_max(unit, port + 1);
    if (speed == 0 && P2L(unit, port + 1) >= 0) {
        return 1;
    }

    speed = _default_port_speed_max(unit, port + 2);
    if (speed == 0 && P2L(unit, port + 2) >= 0) {
        return 1;
    }

    return 0;
}

static int
_uc_q_num_config(int unit)
{
    cdk_pbmp_t mmu_pbmp;
    int port, num_uc_q;
    int base = 0;

    /* Get front-panel ports */
    bcm56340_a0_xport_pbmp_get(unit, XPORT_FLAG_ALL, &mmu_pbmp);
    CDK_PBMP_ITER(mmu_pbmp, port) {
        num_uc_q = bcm56340_a0_mmu_port_uc_queues(unit, port);
        _uc_q_base[unit][port] = base;
        base += (num_uc_q + 3) & ~0x3;
    }
    return 0;
}

int
bcm56340_a0_tdm_default(int unit, const int **tdm_seq)
{
    _cfg_map_t *tdm = &_port_cfgs[_cfg_idx[unit]].tdm;

    *tdm_seq = tdm->val;

    return tdm->size;
}

int
bcm56340_a0_xport_pbmp_get(int unit, int flag, cdk_pbmp_t *pbmp)
{
    int port;
    cdk_pbmp_t xpbmp;

    CDK_PBMP_CLEAR(*pbmp) ;
    
    if (flag & XPORT_FLAG_XTPORT) {
        CDK_XGSM_BLKTYPE_PBMP_GET(unit, BLKTYPE_XTPORT, &xpbmp);
        CDK_PBMP_OR(*pbmp, xpbmp);
    }
    if (flag & XPORT_FLAG_XLPORT) {
        CDK_XGSM_BLKTYPE_PBMP_GET(unit, BLKTYPE_XLPORT, &xpbmp);
        CDK_PBMP_OR(*pbmp, xpbmp);
    }
    if (flag & XPORT_FLAG_XWPORT) {
        CDK_XGSM_BLKTYPE_PBMP_GET(unit, BLKTYPE_XWPORT, &xpbmp);
        CDK_PBMP_OR(*pbmp, xpbmp);
    }
    
    CDK_PBMP_ITER(*pbmp, port) {
        if (BMD_PORT_PROPERTIES(unit, port) == 0) {
            CDK_PBMP_PORT_REMOVE(*pbmp, port);
        }
    }
    
    return 0;
}

int
bcm56340_a0_p2l(int unit, int port, int inverse)
{
    _cfg_map_t *pmap = &_port_cfgs[_cfg_idx[unit]].p2l;
    int pp;

    /* Fixed mappings */
    if (port == CMIC_PORT) {
        return CMIC_LPORT;
    }

    /* Use per-port config if available */
    if (CDK_NUM_PORT_CONFIGS(unit) != 0) {
        if (inverse) {
            for (pp = 0; pp < NUM_PHYS_PORTS; pp++) {
                if (port == CDK_PORT_CONFIG_SYS_PORT(unit, pp)) {
                    return pp;
                }
            }
            return -1;
        } else {
            return CDK_PORT_CONFIG_SYS_PORT(unit, port);
        }
    }

    if (inverse) {
        for (pp = 0; pp < pmap->size; pp++) {
            if (port == pmap->val[pp]) {
                return pp;
            }
        }
        return -1;
    }
    if (port >= pmap->size) {
        return -1;
    }
    return pmap->val[port];
}

int
bcm56340_a0_p2m(int unit, int port, int inverse)
{
    _cfg_map_t *pmap = &_port_cfgs[_cfg_idx[unit]].p2m;
    int pp;

    if (inverse) {
        for (pp = 0; pp < pmap->size; pp++) {
            if (port == pmap->val[pp]) {
                return pp;
            }
        }
        return -1;
    }
    if (port >= pmap->size) {
        return -1;
    }
    return pmap->val[port];
}

uint32_t
bcm56340_a0_port_speed_max(int unit, int port)
{
    /* Use per-port config if available */
    if (CDK_NUM_PORT_CONFIGS(unit) != 0) {
        return CDK_PORT_CONFIG_SPEED_MAX(unit, port);
    }
    return _default_port_speed_max(unit, port);
}

int
bcm56340_a0_mmu_port_mc_queues(int unit, int port)
{
    int mport = P2M(unit, port);

    if (mport == 57 || mport >= 62 || mport < 0) {
        return 0;
    }
    if (mport == 59) {
        return 48;
    }
    if (mport >= 40 && mport <= 55) {
        return 10;
    }
    if (mport == 61) {
        return 1;
    }
    return 8;
}

int
bcm56340_a0_mmu_port_uc_queues(int unit, int port)
{
    int mport;

    if (bcm56340_a0_port_speed_max(unit, port) >= 100000) {
        return 16;
    }
    mport = P2M(unit, port);
    if (mport >= 40 && mport <= 55) {
        return 10;
    }
    return 8;
}

int
bcm56340_a0_mc_queue_num(int unit, int port, int cosq)
{
    int qnum, mport;

    if (port >= 0 && port < BMD_CONFIG_MAX_PORTS) {
        mport = P2M(unit, port);
        if (mport >= 0 && mport <= 39) {
            qnum = MMU_QBASE_MC + mport * 8;
        } else if (mport >= 40 && mport <= 55) {
            qnum = MMU_QBASE_MC_HG + (mport - 40) * 10;
        } else if (mport == 60) {
            qnum = MMU_QBASE_MC_GE;
        } else {
            CDK_WARN(("Unsupported MMU port %d\n", mport));
            return -1;
        }
        return qnum + cosq;
    }
    return -1;
}

int
bcm56340_a0_uc_queue_num(int unit, int port, int cosq)
{
    if (port >= 0 && port < BMD_CONFIG_MAX_PORTS) {
        return _uc_q_base[unit][port] + cosq;
    }
    return -1;
}

int
bcm56340_a0_bmd_attach(int unit)
{
    int port, idx;
    int port_cfg = -1;
    uint32_t port_type_xe = 0;
    uint32_t port_type_hg = 0;
    uint32_t port_type_flex = 0;
    uint32_t speed_max;
    cdk_pbmp_t pbmp_all, pbmp;
#if BMD_CONFIG_INCLUDE_PHY == 1
    phy_bus_t **phy_bus = bcm56340_phy_bus;
#endif

    if (!CDK_DEV_EXISTS(unit)) {
        return CDK_E_UNIT;
    }

#if BMD_CONFIG_INCLUDE_HIGIG == 1 || BMD_CONFIG_INCLUDE_XE == 1
    port_type_xe = BMD_PORT_XE;
    port_type_hg = BMD_PORT_HG;
    port_type_flex = BMD_PORT_FLEX;
#endif

    if (CDK_XGSM_FLAGS(unit) & CHIP_FLAG_NO_DPI) {
        if (CDK_XGSM_FLAGS(unit) & CHIP_FLAG_BW150G) {
            port_cfg = 420;
            if (CDK_XGSM_FLAGS(unit) & CHIP_FLAG_NO_FQ) {
                port_cfg = 11;
            }
        } else {
            port_cfg = 450;
        }
    } else if (CDK_XGSM_FLAGS(unit) & CHIP_FLAG_NH1K) {
        if (CDK_XGSM_FLAGS(unit) & CHIP_FLAG_BW150G) {
            port_cfg = 420;
        } else {
            port_cfg = 510;
            if (CDK_XGSM_FLAGS(unit) & CHIP_FLAG_FQ7) {
                port_cfg = 514;
            }
        }
    } else if (CDK_XGSM_FLAGS(unit) & CHIP_FLAG_LPM32K) {
        if (CDK_XGSM_FLAGS(unit) & CHIP_FLAG_FQ7) {
            port_cfg = 491;
        } else {
            port_cfg = 495;
            if (CDK_CHIP_CONFIG(unit) & DCFG_3X42) {
                port_cfg = 490;
            } else if (CDK_CHIP_CONFIG(unit) & DCFG_2X42) {
                port_cfg = 500;
            }
        }
    } else if (CDK_XGSM_FLAGS(unit) & CHIP_FLAG_BW130G) {
        port_cfg = 460;
    } else if (CDK_XGSM_FLAGS(unit) & CHIP_FLAG_NO_HG) {
        port_cfg = 497;
        if (CDK_CHIP_CONFIG(unit) & DCFG_2X10) {
            port_cfg = 510;
        }
    } else {
        port_cfg = 400;
        if (CDK_CHIP_CONFIG(unit) & DCFG_4X10) {
            port_cfg = 410;
        } else if (CDK_CHIP_CONFIG(unit) & DCFG_2X10) {
            port_cfg = 610;
        }
    }
    
    if (port_cfg == -1) {
        return CDK_E_CONFIG;
    }

    /* Select port configuration */
    for (idx = 0; idx < COUNTOF(_port_cfgs); idx++) {
        if (port_cfg == _port_cfgs[idx].id) {
            _cfg_idx[unit] = idx;
            break;
         }
    }
    if (idx == COUNTOF(_port_cfgs)) {
        CDK_WARN(("bcm56340_a0_bmd_attach[%d]: Invalid port config (%d)\n", unit, port_cfg));
    }

    CDK_XGSM_BLKTYPE_PBMP_GET(unit, BLKTYPE_XLPORT, &pbmp_all);
    CDK_XGSM_BLKTYPE_PBMP_GET(unit, BLKTYPE_XTPORT, &pbmp);
    CDK_PBMP_OR(pbmp_all, pbmp);
    CDK_XGSM_BLKTYPE_PBMP_GET(unit, BLKTYPE_XWPORT, &pbmp);
    CDK_PBMP_OR(pbmp_all, pbmp);
    
    CDK_PBMP_ITER(pbmp_all, port) {
        CDK_ASSERT(port < BMD_CONFIG_MAX_PORTS);
        
        BMD_PORT_PROPERTIES(unit, port) = 0;
        if (_is_flex_port(unit, port)) {
            BMD_PORT_PROPERTIES(unit, port) = port_type_flex;
        } 
        
        speed_max = bcm56340_a0_port_speed_max(unit, port);
        if (speed_max > 10000) {
            BMD_PORT_PROPERTIES(unit, port) |= port_type_hg;
        } else if (speed_max >=2500) {
            BMD_PORT_PROPERTIES(unit, port) |= port_type_xe;
        } else if (speed_max != 0) {
            BMD_PORT_PROPERTIES(unit, port) |= BMD_PORT_GE;
        }
        
        if (BMD_PORT_PROPERTIES(unit, port) == 0) {
            continue ;
        }
        PHY_BUS_SET(unit, port, phy_bus);
    }

    port = CMIC_PORT;
    CDK_ASSERT(port < BMD_CONFIG_MAX_PORTS);
    BMD_PORT_PROPERTIES(unit, port) = BMD_PORT_CPU;

#if CDK_CONFIG_INCLUDE_PORT_MAP == 1
    /* Match default API port map to configured logical ports */
    _init_port_map(unit);
#endif

    /* Initialize debug functions */
    BMD_PORT_SPEED_MAX(unit) = bcm56340_a0_port_speed_max;
    BMD_PORT_P2L(unit) = bcm56340_a0_p2l;
    BMD_PORT_P2M(unit) = bcm56340_a0_p2m;

    BMD_DEV_FLAGS(unit) |= BMD_DEV_ATTACHED;

    /* Configure unicast queues for linked list scheduler (LLS) */
    _uc_q_num_config(unit);

    return 0; 
}
#endif /* CDK_CONFIG_INCLUDE_BCM56340_A0 */
